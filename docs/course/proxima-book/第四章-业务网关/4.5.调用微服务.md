接下来，我们要在控制器里调用微服务，完成具体的业务逻辑。

> 实际开发中，复杂业务逻辑需要封装到`logic`中，像`Web`单体服务一样，由控制器调用。

## 用户服务
---
*app/gateway/internal/controller/user/user_v1_login.go*
```go
package user  
  
import (  
    "context"  
  
    "proxima/app/gateway/utility"
    account "proxima/app/user/api/account/v1"  
  
    "proxima/app/gateway/api/user/v1"
)  
  
func (c *ControllerV1) Login(ctx context.Context, req *v1.LoginReq) (res *v1.LoginRes, err error) {  
    var (  
       conn   = utility.UserClientConn()  
       client = account.NewAccountClient(conn)  
    )  
    
	ctx, cancel := context.WithTimeout(ctx, utility.Timeout)  
	defer cancel()
  
    user, err := client.UserLogin(ctx, &account.UserLoginReq{  
       Username: req.Username,  
       Password: req.Password,  
    })  
  
    if err != nil {  
       return nil, err  
    }  
  
    return &v1.LoginRes{  
       Token: user.GetToken(),  
    }, nil  
}
```

发起请求测试，网关调用微服务是否成功：
```bash
$ curl -X POST http://127.0.0.1:8000/v1/users/login \
     -H "Content-Type: application/json" \
     -d '{
           "username": "oldme",
           "password": "12345678"
         }'

{
    "code": 0,
    "message": "",
    "data": {
        "token": "I am token"
    }
}
```

看到这个返回结果，恭喜您，大功告成。接下来，您可以尝试把其他的几个服务也开发出来。这里我贴出源码，您可以对照着看看。

## 单词服务
---
*app/gateway/internal/controller/words/words_v1_create.go*
```go
package words  
  
import (  
    "context"  
  
    "proxima/app/gateway/utility"
    words "proxima/app/word/api/words/v1"  
  
    "proxima/app/gateway/api/words/v1"
)  
  
func (c *ControllerV1) Create(ctx context.Context, req *v1.CreateReq) (res *v1.CreateRes, err error) {  
    var (  
       conn   = utility.WordClientConn()  
       client = words.NewWordsClient(conn)  
    )  
    
  	ctx, cancel := context.WithTimeout(ctx, utility.Timeout)  
	defer cancel()
	
    _, err = client.Create(ctx, &words.CreateReq{  
       Uid:        1,  
       Word:       req.Word,  
       Definition: req.Definition,  
    })  
  
    if err != nil {  
       return nil, err  
    }  
  
    return &v1.CreateRes{}, nil  
}
```

*app/gateway/internal/controller/words/words_v1_detail.go*
```go
package words  
  
import (  
    "context"  
  
    "github.com/gogf/gf/v2/errors/gerror"
    "proxima/app/gateway/utility"
    words "proxima/app/word/api/words/v1"  
  
    "proxima/app/gateway/api/words/v1")  
  
func (c *ControllerV1) Detail(ctx context.Context, req *v1.DetailReq) (res *v1.DetailRes, err error) {  
    var (  
       conn   = utility.WordClientConn()  
       client = words.NewWordsClient(conn)  
    )  
    
	ctx, cancel := context.WithTimeout(ctx, utility.Timeout)  
	defer cancel()
	
    word, err := client.Get(ctx, &words.GetReq{  
       Id: uint32(req.Id),  
    })  
  
    if err != nil {  
       return nil, err  
    }  
  
    if word == nil {  
       return nil, gerror.New("word not found")  
    }  
  
    return &v1.DetailRes{  
       Id:         uint(word.Words.Id),  
       Word:       word.Words.Word,  
       Definition: word.Words.Definition,  
    }, nil  
}
```