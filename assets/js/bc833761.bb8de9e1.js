"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["77811"],{371801:function(n,e,r){r.r(e),r.d(e,{metadata:()=>t,contentTitle:()=>l,default:()=>d,assets:()=>a,toc:()=>s,frontMatter:()=>i});var t=JSON.parse('{"id":"course/proxima-book/\u7B2C\u56DB\u7AE0-\u4E1A\u52A1\u7F51\u5173/4.4.gRPC\u5BA2\u6237\u7AEF","title":"4.4.\u5C01\u88C5gRPC\u5BA2\u6237\u7AEF","description":"\u8BE6\u7EC6\u4ECB\u7ECD\u4E86\u5982\u4F55\u5728\u4E1A\u52A1\u7F51\u5173\u4E2D\u5C01\u88C5\u548C\u914D\u7F6E gRPC \u5BA2\u6237\u7AEF\uFF0C\u5B9E\u73B0\u4E0E\u5FAE\u670D\u52A1\u7684\u901A\u4FE1\uFF0C\u5305\u62EC\u5BA2\u6237\u7AEF\u521D\u59CB\u5316\u3001\u670D\u52A1\u53D1\u73B0\u7B49\u529F\u80FD\u3002","source":"@site/docs/course/proxima-book/\u7B2C\u56DB\u7AE0-\u4E1A\u52A1\u7F51\u5173/4.4.gRPC\u5BA2\u6237\u7AEF.md","sourceDirName":"course/proxima-book/\u7B2C\u56DB\u7AE0-\u4E1A\u52A1\u7F51\u5173","slug":"/course/proxima-book/gateway-client","permalink":"/course/proxima-book/gateway-client","draft":false,"unlisted":false,"editUrl":"https://github.com/gogf/gf-site/blob/main/docs/course/proxima-book/\u7B2C\u56DB\u7AE0-\u4E1A\u52A1\u7F51\u5173/4.4.gRPC\u5BA2\u6237\u7AEF.md","tags":[],"version":"current","lastUpdatedBy":"oldme","lastUpdatedAt":1734398801000,"frontMatter":{"title":"4.4.\u5C01\u88C5gRPC\u5BA2\u6237\u7AEF","hide_title":true,"slug":"/course/proxima-book/gateway-client","keywords":["GoFrame","gRPC client","microservices communication","client configuration","service discovery","etcd integration"],"description":"\u8BE6\u7EC6\u4ECB\u7ECD\u4E86\u5982\u4F55\u5728\u4E1A\u52A1\u7F51\u5173\u4E2D\u5C01\u88C5\u548C\u914D\u7F6E gRPC \u5BA2\u6237\u7AEF\uFF0C\u5B9E\u73B0\u4E0E\u5FAE\u670D\u52A1\u7684\u901A\u4FE1\uFF0C\u5305\u62EC\u5BA2\u6237\u7AEF\u521D\u59CB\u5316\u3001\u670D\u52A1\u53D1\u73B0\u7B49\u529F\u80FD\u3002"},"sidebar":"courseProximaBookSidebar","previous":{"title":"4.3.\u542F\u52A8\u8FD0\u884C","permalink":"/course/proxima-book/gateway-run"},"next":{"title":"4.5.\u8C03\u7528\u5FAE\u670D\u52A1","permalink":"/course/proxima-book/gateway-call"}}'),o=r("785893"),c=r("250065");let i={title:"4.4.\u5C01\u88C5gRPC\u5BA2\u6237\u7AEF",hide_title:!0,slug:"/course/proxima-book/gateway-client",keywords:["GoFrame","gRPC client","microservices communication","client configuration","service discovery","etcd integration"],description:"\u8BE6\u7EC6\u4ECB\u7ECD\u4E86\u5982\u4F55\u5728\u4E1A\u52A1\u7F51\u5173\u4E2D\u5C01\u88C5\u548C\u914D\u7F6E gRPC \u5BA2\u6237\u7AEF\uFF0C\u5B9E\u73B0\u4E0E\u5FAE\u670D\u52A1\u7684\u901A\u4FE1\uFF0C\u5305\u62EC\u5BA2\u6237\u7AEF\u521D\u59CB\u5316\u3001\u670D\u52A1\u53D1\u73B0\u7B49\u529F\u80FD\u3002"},l=void 0,a={},s=[{value:"\u5BA2\u6237\u7AEF",id:"\u5BA2\u6237\u7AEF",level:2},{value:"\u62E6\u622A\u5668",id:"\u62E6\u622A\u5668",level:2},{value:"\u5B9A\u4E49\u62E6\u622A\u5668",id:"\u5B9A\u4E49\u62E6\u622A\u5668",level:3},{value:"\u8C03\u7528\u62E6\u622A\u5668",id:"\u8C03\u7528\u62E6\u622A\u5668",level:3}];function p(n){let e={code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",p:"p",pre:"pre",...(0,c.a)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.h2,{id:"\u5BA2\u6237\u7AEF",children:"\u5BA2\u6237\u7AEF"}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsxs)(e.p,{children:["\u4E1A\u52A1\u7F51\u5173\u76F8\u5F53\u4E8E",(0,o.jsx)(e.code,{children:"gRPC"}),"\u5BA2\u6237\u7AEF\uFF0C\u5404\u4E2A\u5FAE\u670D\u52A1\u76F8\u5F53\u4E8E",(0,o.jsx)(e.code,{children:"gRPC"}),"\u670D\u52A1\u7AEF\u3002\u6211\u4EEC\u5C06\u5728\u63A7\u5236\u5668\u5C5E\u6027\u91CC\uFF0C\u5B9A\u4E49",(0,o.jsx)(e.code,{children:"gRPC client"}),"\uFF0C\u4F9B\u540E\u7EED\u4F7F\u7528\u3002"]}),"\n",(0,o.jsxs)(e.p,{children:["\u5B9A\u4E49",(0,o.jsx)(e.code,{children:"client"}),"\u7531",(0,o.jsx)(e.code,{children:"grpcx.Client.MustNewGrpcClientConn(service, opts...)"}),"\u5B8C\u6210\u3002"]}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.em,{children:"app/gateway/internal/controller/user/user_new.go"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-go",children:'package user  \n  \nimport (  \n    "github.com/gogf/gf/contrib/rpc/grpcx/v2"  \n    "proxima/app/gateway/api/user"\n    v1 "proxima/app/user/api/account/v1"  \n)  \n  \ntype ControllerV1 struct {  \n    AccountClient v1.AccountClient  \n}  \n  \nfunc NewV1() user.IUserV1 {  \n    var conn = grpcx.Client.MustNewGrpcClientConn("user")  \n  \n    return &ControllerV1{  \n       AccountClient: v1.NewAccountClient(conn),  \n    }  \n}\n'})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.em,{children:"app/gateway/internal/controller/words/words_new.go"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-go",children:'package words  \n  \nimport (  \n    "github.com/gogf/gf/contrib/rpc/grpcx/v2"  \n    "proxima/app/gateway/api/words"\n    v1 "proxima/app/word/api/words/v1"  \n)  \n  \ntype ControllerV1 struct {  \n    WordsClient v1.WordsClient  \n}  \n  \nfunc NewV1() words.IWordsV1 {  \n    var conn = grpcx.Client.MustNewGrpcClientConn("word")  \n  \n    return &ControllerV1{  \n       WordsClient: v1.NewWordsClient(conn),  \n    }  \n}\n'})}),"\n",(0,o.jsx)(e.h2,{id:"\u62E6\u622A\u5668",children:"\u62E6\u622A\u5668"}),"\n",(0,o.jsx)(e.hr,{}),"\n",(0,o.jsxs)(e.p,{children:["\u5F53\u524D\u5BA2\u6237\u7AEF\u6CA1\u6709\u8D85\u65F6\u5904\u7406\uFF0C",(0,o.jsx)(e.code,{children:"gRPC"}),"\u7684\u9ED8\u8BA4\u8D85\u65F6\u65F6\u95F4\u9608\u503C\u53C8\u975E\u5E38\u5927\u3002\u5982\u679C",(0,o.jsx)(e.code,{children:"gRPC"}),"\u670D\u52A1\u7AEF\u3001",(0,o.jsx)(e.code,{children:"etcd"}),"\u670D\u52A1\uFF0C\u6216\u8005\u7F51\u7EDC\u51FA\u73B0\u5F02\u5E38\uFF0C\u4E1A\u52A1\u7F51\u5173\u4F1A\u65E0\u9650\u5361\u6B7B\u3002\u6211\u4EEC\u6765\u6DFB\u52A0\u8D85\u65F6\u62E6\u622A\u5668\uFF0C\u4EE5\u5E94\u5BF9\u8FD9\u79CD\u60C5\u51B5\u3002"]}),"\n",(0,o.jsx)(e.h3,{id:"\u5B9A\u4E49\u62E6\u622A\u5668",children:"\u5B9A\u4E49\u62E6\u622A\u5668"}),"\n",(0,o.jsxs)(e.p,{children:["\u8D85\u65F6\u673A\u5236\u5F88\u7B80\u5355\uFF0C\u901A\u8FC7",(0,o.jsx)(e.code,{children:"Go"}),"\u7684\u4E0A\u4E0B\u6587\u63D0\u4F9B\u3002"]}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.em,{children:"app/gateway/utility/grpc.go"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-go",children:'package utility  \n  \nimport (  \n    "context"  \n    "time"  \n    "google.golang.org/grpc"\n)  \n  \nfunc GrpcClientTimeout(ctx context.Context, method string, req, reply interface{},  \n    cc *grpc.ClientConn, invoker grpc.UnaryInvoker, opts ...grpc.CallOption,  \n) error {  \n    ctx, cancel := context.WithTimeout(ctx, 3*time.Second)  \n    defer cancel()  \n  \n    err := invoker(ctx, method, req, reply, cc, opts...)  \n    return err  \n}\n'})}),"\n",(0,o.jsx)(e.h3,{id:"\u8C03\u7528\u62E6\u622A\u5668",children:"\u8C03\u7528\u62E6\u622A\u5668"}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.em,{children:"app/gateway/internal/controller/user/user_new.go"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-go",children:'package user  \n  \nimport (  \n    "github.com/gogf/gf/contrib/rpc/grpcx/v2"  \n    "proxima/app/gateway/api/user"\n    "proxima/app/gateway/utility"\n    v1 "proxima/app/user/api/account/v1"  \n)  \n  \ntype ControllerV1 struct {  \n    AccountClient v1.AccountClient  \n}  \n  \nfunc NewV1() user.IUserV1 {  \n    var conn = grpcx.Client.MustNewGrpcClientConn("user", grpcx.Client.ChainUnary( \n        utility.GrpcClientTimeout,  \n    ))  \n  \n    return &ControllerV1{  \n       AccountClient: v1.NewAccountClient(conn),  \n    }  \n}\n'})}),"\n",(0,o.jsx)(e.p,{children:(0,o.jsx)(e.em,{children:"app/gateway/internal/controller/words/words_new.go"})}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-go",children:'package words  \n  \nimport (  \n    "github.com/gogf/gf/contrib/rpc/grpcx/v2"  \n    "proxima/app/gateway/api/words"\n    "proxima/app/gateway/utility"\n    v1 "proxima/app/word/api/words/v1"  \n)  \n  \ntype ControllerV1 struct {  \n    WordsClient v1.WordsClient  \n}  \n  \nfunc NewV1() words.IWordsV1 {  \n    var conn = grpcx.Client.MustNewGrpcClientConn("word", grpcx.Client.ChainUnary( \n        utility.GrpcClientTimeout,  \n    ))\n  \n    return &ControllerV1{  \n       WordsClient: v1.NewWordsClient(conn),  \n    }  \n}\n'})})]})}function d(n={}){let{wrapper:e}={...(0,c.a)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(p,{...n})}):p(n)}},250065:function(n,e,r){r.d(e,{Z:function(){return l},a:function(){return i}});var t=r(667294);let o={},c=t.createContext(o);function i(n){let e=t.useContext(c);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:i(n.components),t.createElement(c.Provider,{value:e},n.children)}}}]);