<!doctype html><html lang=en-US dir=ltr class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-docs/框架设计/工程开发设计/DAO封装设计/DAO-组件痛点及改进" data-has-hydrated=false><meta charset=UTF-8><meta name=generator content="Docusaurus v3.6.3"><title data-rh=true>Pain Points and Improvements In ORM Component | GoFrame - A powerful framework for faster, easier, and more efficient project development</title><meta data-rh=true name=viewport content="width=device-width,initial-scale=1.0"><meta data-rh=true name=twitter:card content=summary_large_image><meta data-rh=true property=og:url content=https://goframe.org/en/docs/design/project-dao-pain><meta data-rh=true property=og:locale content=en_US><meta data-rh=true property=og:locale:alternate content=zh_Hans><meta data-rh=true name=docusaurus_locale content=en><meta data-rh=true name=docsearch:language content=en><meta data-rh=true name=docusaurus_version content=current><meta data-rh=true name=docusaurus_tag content=docs-default-current><meta data-rh=true name=docsearch:version content=current><meta data-rh=true name=docsearch:docusaurus_tag content=docs-default-current><meta data-rh=true property=og:title content="Pain Points and Improvements In ORM Component | GoFrame - A powerful framework for faster, easier, and more efficient project development"><meta data-rh=true name=description content="The advantages of using DAO design in the GoFrame framework, and the pain points and solutions in using existing ORM components. Through DAO design, it greatly improves development and maintenance efficiency, reduces code coupling, and increases observability support. The article details how to overcome common issues when using ORM, such as field mapping, hardcoding, and data structure inconsistencies. Additionally, the improvement design includes the encapsulation of DAO objects and support for SQL logging functionality."><meta data-rh=true property=og:description content="The advantages of using DAO design in the GoFrame framework, and the pain points and solutions in using existing ORM components. Through DAO design, it greatly improves development and maintenance efficiency, reduces code coupling, and increases observability support. The article details how to overcome common issues when using ORM, such as field mapping, hardcoding, and data structure inconsistencies. Additionally, the improvement design includes the encapsulation of DAO objects and support for SQL logging functionality."><meta data-rh=true name=keywords content="DAO,GoFrame,Data Access Object,ORM,GRPC,Database Optimization,Code Encapsulation,Automatic Mapping,SQL Logs,Code Generation"><link data-rh=true rel=icon href=/en/img/favicon.ico><link data-rh=true rel=canonical href=https://goframe.org/en/docs/design/project-dao-pain><link data-rh=true rel=alternate href=https://goframe.org/docs/design/project-dao-pain hreflang=zh-Hans><link data-rh=true rel=alternate href=https://goframe.org/en/docs/design/project-dao-pain hreflang=en-US><link data-rh=true rel=alternate href=https://goframe.org/docs/design/project-dao-pain hreflang=x-default><link data-rh=true rel=preconnect href=https://ZQUL8VI47R-dsn.algolia.net crossorigin><link rel=search type=application/opensearchdescription+xml title="GoFrame - A powerful framework for faster, easier, and more efficient project development" href=/en/opensearch.xml><script src=https://hm.baidu.com/hm.js?38f38a0626fd7805722db06243cd0fa7 async></script><link rel=stylesheet href=/en/assets/css/styles.b09a3e0d.css><script src=/en/assets/js/main.9d91b445.js defer></script><script src=/en/assets/js/runtime~main.ae76532e.js defer></script><body class=navigation-with-keyboard><script>!function(){var t,e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t=null!==e?e:"light",document.documentElement.setAttribute("data-theme",t)}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="navbar navbar--fixed-top"><div class=navbar__inner><div class=navbar__items><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/en/><div class=navbar__logo><img src=/en/img/logo2.png alt="GoFrame Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src=/en/img/logo2.png alt="GoFrame Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" sidebarid=quickSidebar href=/en/quick/install>Quick Start</a><a class="navbar__item navbar__link" sidebarid=mainSidebar href=/en/docs/core>Documentation</a><div class="navbar__item dropdown dropdown--hoverable"><a class=navbar__link aria-haspopup=true aria-expanded=false role=button sidebarid=courseSidebar href=/en/course>Courses</a><ul class=dropdown__menu><li><a class=dropdown__link sidebarid=courseSidebar href=/en/course/bilibili-video>Video Tutorial(Chinese)</a><li><a class=dropdown__link sidebarid=courseStarBookSidebar href=/en/course/starbook>Practical Tutorial - Star English Book</a><li><a class=dropdown__link sidebarid=courseProximaBookSidebar href=/en/course/proxima-book>Microservice Tutorial - Proxima Book</a></ul></div><a class="navbar__item navbar__link" href=/en/examples/grpc>Examples</a><a class="navbar__item navbar__link" href=/en/showcase>Show Case</a><a class="navbar__item navbar__link" href=/en/release/note>Releases</a><a class="navbar__item navbar__link" sidebarid=communitySidebar href=/en/share/group>Community</a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class=navbar__link aria-haspopup=true aria-expanded=false role=button href=/en/docs/design/project-dao-pain>2.8.x(Latest)</a><ul class=dropdown__menu><li><a aria-current=page class="dropdown__link dropdown__link--active" href=/en/docs/design/project-dao-pain>2.8.x(Latest)</a><li><a class=dropdown__link href=/en/2.7.x/docs/design/project-dao-pain>2.7.x</a><li><a class=dropdown__link href=/en/2.6.x/项目开发>2.6.x</a><li><a class=dropdown__link href=/en/2.5.x/项目开发>2.5.x</a><li><a class=dropdown__link href=/en/2.4.x/开发工具>2.4.x</a><li><a class=dropdown__link href=/en/2.3.x/开发工具>2.3.x</a><li><a class=dropdown__link href=/en/2.2.x/开发工具>2.2.x</a><li><a class=dropdown__link href=/en/2.1.x/开发工具>2.1.x</a><li><a class=dropdown__link href=/en/2.0.x/开发工具>2.0.x</a><li><a class=dropdown__link href=/en/1.16.x/开发工具>1.16.x</a></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href=# aria-haspopup=true aria-expanded=false role=button class=navbar__link><svg viewBox="0 0 24 24" width=20 height=20 aria-hidden=true class=iconLanguage_nlXk><path fill=currentColor d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>English</a><ul class=dropdown__menu><li><a href=/docs/design/project-dao-pain rel="noopener noreferrer" class=dropdown__link lang=zh-Hans>简体中文</a><li><a href=/en/docs/design/project-dao-pain rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang=en-US>English</a></ul></div><a href=https://github.com/gogf/gf target=_blank rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 20 20" aria-hidden=true><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke=currentColor fill=none fill-rule=evenodd stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/cli>CLI Tool</a><button aria-label="Expand sidebar category 'CLI Tool'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/core>Core Components 🔥</a><button aria-label="Expand sidebar category 'Core Components 🔥'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/components>Components Category</a><button aria-label="Expand sidebar category 'Components Category'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/web>WEB Service Development</a><button aria-label="Expand sidebar category 'WEB Service Development'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/micro-service>Microservice Development</a><button aria-label="Expand sidebar category 'Microservice Development'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/obs>Service Observability</a><button aria-label="Expand sidebar category 'Service Observability'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/en/docs/faq>Frequently Asked Questions (FAQ)</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/deploy>Project Deployment</a><button aria-label="Expand sidebar category 'Project Deployment'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" href=/en/docs/design>Framework Design</a><button aria-label="Collapse sidebar category 'Framework Design'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/design/modular>Modular Design</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/design/unified>Unified Framework Design</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/en/docs/design/project>Engineering Design 🔥</a><button aria-label="Collapse sidebar category 'Engineering Design 🔥'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/design/project-layer>Code Layering</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/design/project-structure>Project Structure🔥</a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist menu__link--active" tabindex=0 href=/en/docs/design/project-dao>DAO Encapsulation</a><button aria-label="Collapse sidebar category 'DAO Encapsulation'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul style=display:block;overflow:visible;height:auto class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/en/docs/design/project-dao-pain>Pain Points and Improvements In ORM Component</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/design/project-dao-improvement>Pain Points and Improvements In Business Project</a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/design/project-struct-parameter>Structured Programming</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/design/project-models>Data and Business Models</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/design/project-mono-repo>Mono-Repo Management</a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/design/tracing>OpenTelemetry Tracing</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/design/error-stack>Error Stack</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/design/interface-generic>Interface and Generic</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/design/initialization>Implicit and Explicit Init</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/design/enums>Golang Enums</a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/en/docs/design/context-variable>Context Shared Variables</a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="menu__link menu__link--sublist" href=/en/docs/other>Other Documents</a><button aria-label="Expand sidebar category 'Other Documents'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/en/docs/changelog>Docs Changelog</a></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs itemscope itemtype=https://schema.org/BreadcrumbList><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/en/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/en/docs/design><span itemprop=name>Framework Design</span></a><meta itemprop=position content=1><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/en/docs/design/project><span itemprop=name>Engineering Design 🔥</span></a><meta itemprop=position content=2><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class=breadcrumbs__item><a class=breadcrumbs__link itemprop=item href=/en/docs/design/project-dao><span itemprop=name>DAO Encapsulation</span></a><meta itemprop=position content=3><li itemscope itemprop=itemListElement itemtype=https://schema.org/ListItem class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link itemprop=name>Pain Points and Improvements In ORM Component</span><meta itemprop=position content=4></ul></nav><span class="theme-doc-version-badge badge badge--secondary">Version: 2.8.x(Latest)</span><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><p>The design of <code>DAO</code> (Data Access Object) is actually a significant part of the engineering practices in the <code>GoFrame</code> framework.</p>
<p>The <code>DAO</code> design, combined with the <code>ORM</code> component of <code>GoFrame</code>, offers strong performance and ease of use, which can greatly enhance development and maintenance efficiency. After reading this chapter, individuals should be able to understand and appreciate the advantages of using DAO database access object design.</p>
<div class="theme-admonition theme-admonition-info admonition_xJq3 alert alert--info"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg></span>info</div><div class=admonitionContent_BuS1><p>I review this article every year to see if any parts can be removed. However, I am always disappointed because this article still applies to the current situation. I have even added new content this year.</div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=1-current-orm-usage-example>1. Current <code>ORM</code> Usage Example<a href=#1-current-orm-usage-example class=hash-link aria-label="Direct link to 1-current-orm-usage-example" title="Direct link to 1-current-orm-usage-example">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=1-need-to-define-models>1. Need to Define Models<a href=#1-need-to-define-models class=hash-link aria-label="Direct link to 1. Need to Define Models" title="Direct link to 1. Need to Define Models">​</a></h3>
<p><img decoding=async loading=lazy src=/en/assets/images/77daf5d299eabade856d950ab3161f94-b50361a3a6232ba6d81f0d79e67df4c5.png width=1065 height=432 class=img_ev3q> Basic User Table (for demonstration purposes only, real table has dozens of fields)</p>
<p><img decoding=async loading=lazy src=/en/assets/images/f4e8c70ee25ec329f2b64bb3a53ff503-1d32e08995f781aa0ffe379eba54a94d.png width=1160 height=646 class=img_ev3q> Doctor Information Table (for demonstration purposes only, real table has hundreds of fields)</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=2-grpc-interface-implementation-example>2. <code>GRPC</code> Interface Implementation Example<a href=#2-grpc-interface-implementation-example class=hash-link aria-label="Direct link to 2-grpc-interface-implementation-example" title="Direct link to 2-grpc-interface-implementation-example">​</a></h3>
<p>A simple <code>GRPC</code> information query interface.</p>
<p><img decoding=async loading=lazy src=/en/assets/images/b45b3af0a0bdc9ad30f739e31d0039ae-88e9e808d4ffdf213440b3e3bdc4770b.png width=1154 height=894 class=img_ev3q> A simple <code>GRPC</code> data query interface</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=2-description-of-current-pain-points>2. Description of Current Pain Points<a href=#2-description-of-current-pain-points class=hash-link aria-label="Direct link to 2. Description of Current Pain Points" title="Direct link to 2. Description of Current Pain Points">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=1-must-define-tag-to-associate-table-structure-with-struct-properties-cannot-achieve-automatic-mapping>1. Must Define <code>tag</code> to Associate Table Structure with <code>struct</code> Properties, Cannot Achieve Automatic Mapping<a href=#1-must-define-tag-to-associate-table-structure-with-struct-properties-cannot-achieve-automatic-mapping class=hash-link aria-label="Direct link to 1-must-define-tag-to-associate-table-structure-with-struct-properties-cannot-achieve-automatic-mapping" title="Direct link to 1-must-define-tag-to-associate-table-structure-with-struct-properties-cannot-achieve-automatic-mapping">​</a></h3>
<p>There is already a certain correlation rule between table fields and entity object property names, making it unnecessary to define and maintain a large number of <code>tags</code>.</p>
<p><img decoding=async loading=lazy src=/en/assets/images/f1bb2d203d4fe4f2c44bbc7e14b7832a-f3782e20453de0d57c8efeb5e5f2238a.png width=769 height=644 class=img_ev3q></p>
<p>A large number of unnecessary <code>tag</code> definitions used to map database table fields to entity object properties</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=2-does-not-support-specifying-fields-to-query-via-the-return-object>2. Does Not Support Specifying Fields to Query via the Return Object<a href=#2-does-not-support-specifying-fields-to-query-via-the-return-object class=hash-link aria-label="Direct link to 2. Does Not Support Specifying Fields to Query via the Return Object" title="Direct link to 2. Does Not Support Specifying Fields to Query via the Return Object">​</a></h3>
<p>You cannot specify query fields via the structure of the returned object. Either you can only <code>SELECT *</code> or manually input query fields through additional methods, which is inefficient.</p>
<p><img decoding=async loading=lazy src=/en/assets/images/70e01c869632543b846b04a1696e9737-cd7d25aa20a2d730369db62469f90510.png width=912 height=657 class=img_ev3q></p>
<p>Common <code>SELECT *</code> operation, unable to specify query fields based on the interface object</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=3-unable-to-automatically-filter-field-names-of-input-object-properties>3. Unable to Automatically Filter Field Names of Input Object Properties<a href=#3-unable-to-automatically-filter-field-names-of-input-object-properties class=hash-link aria-label="Direct link to 3. Unable to Automatically Filter Field Names of Input Object Properties" title="Direct link to 3. Unable to Automatically Filter Field Names of Input Object Properties">​</a></h3>
<p>Once the input and output data structures are defined, the output data structure already contains the field names we need to query. Developers define a return object with the expectation that only the fields needed will be queried, automatically filtering out unnecessary properties.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=4-need-to-create-intermediate-query-result-objects-for-assignment-and-conversion>4. Need to Create Intermediate Query Result Objects for Assignment and Conversion<a href=#4-need-to-create-intermediate-query-result-objects-for-assignment-and-conversion class=hash-link aria-label="Direct link to 4. Need to Create Intermediate Query Result Objects for Assignment and Conversion" title="Direct link to 4. Need to Create Intermediate Query Result Objects for Assignment and Conversion">​</a></h3>
<p>Query results do not support intelligent <code>struct</code> conversion, requiring an additional intermediate <code>model</code> model and using other tools to copy, which is inefficient.</p>
<p><img decoding=async loading=lazy src=/en/assets/images/05bf7722da09a27e7ca82bf6e0f89271-c1fa3d038052e85f8ac34728e8852f44.png width=2252 height=1294 class=img_ev3q></p>
<p>Existence of an intermediate temporary model object for taking query results and assigning values to the return structure object</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=5-need-to-pre-initialize-return-objects-regardless-of-whether-data-is-queried>5. Need to Pre-initialize Return Objects Regardless of Whether Data is Queried<a href=#5-need-to-pre-initialize-return-objects-regardless-of-whether-data-is-queried class=hash-link aria-label="Direct link to 5. Need to Pre-initialize Return Objects Regardless of Whether Data is Queried" title="Direct link to 5. Need to Pre-initialize Return Objects Regardless of Whether Data is Queried">​</a></h3>
<p>This approach is inelegant, impacts performance, and is not <code>GC</code> friendly. Expectation is to auto-create return objects only when data is queried and do nothing if no data is found.</p>
<p><img decoding=async loading=lazy src=/en/assets/images/239f4b75b4b77e85bca523371a7dd1b4-9c664ceb37f7b1fda957f96d5864811b.png width=935 height=640 class=img_ev3q></p>
<p>Need to pre-initialize return objects regardless of whether data is queried</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=6-entire-project-uses-low-level-bare-db-object-operations-without-object-encapsulation>6. Entire Project Uses Low-Level Bare <code>DB</code> Object Operations Without Object Encapsulation<a href=#6-entire-project-uses-low-level-bare-db-object-operations-without-object-encapsulation class=hash-link aria-label="Direct link to 6-entire-project-uses-low-level-bare-db-object-operations-without-object-encapsulation" title="Direct link to 6-entire-project-uses-low-level-bare-db-object-operations-without-object-encapsulation">​</a></h3>
<p>Most <code>Golang</code> beginners seem to prefer using a global <code>DB</code> object to create a specific table <code>Model</code> object for <code>CRUD</code> operations. This approach lacks a layered code design, <strong>resulting in high coupling between data operations and business logic</strong>.</p>
<p><img decoding=async loading=lazy src=/en/assets/images/d73fdaa5b76b831db0a2c1069742c218-105f68f458e290a2d03dc0a450c4f6fe.png width=1133 height=668 class=img_ev3q></p>
<p>Primitive database object operation without <code>DAO</code> encapsulation</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=7-ubiquitous-string-hardcoding-such-as-table-names-and-field-hardcoding>7. Ubiquitous String Hardcoding, such as Table Names and Field Hardcoding<a href=#7-ubiquitous-string-hardcoding-such-as-table-names-and-field-hardcoding class=hash-link aria-label="Direct link to 7. Ubiquitous String Hardcoding, such as Table Names and Field Hardcoding" title="Direct link to 7. Ubiquitous String Hardcoding, such as Table Names and Field Hardcoding">​</a></h3>
<p>For instance, if the field <code>userId</code> is accidentally written as <code>UserId</code> or <code>userid</code>, and tests do not fully cover this, it could lead to a new accident under certain circumstances.</p>
<p><img decoding=async loading=lazy src=/en/assets/images/46d8aae38995327c6ce26832d21f628b-aab20cf6cfc3aeb8b4bd9d12e9e87b3d.png width=2402 height=1304 class=img_ev3q></p>
<p>大量的字符串硬编码</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=8-too-many-pointer-property-definitions-caused-by-the-underlying-orm>8. Too Many Pointer Property Definitions Caused by the Underlying ORM<a href=#8-too-many-pointer-property-definitions-caused-by-the-underlying-orm class=hash-link aria-label="Direct link to 8. Too Many Pointer Property Definitions Caused by the Underlying ORM" title="Direct link to 8. Too Many Pointer Property Definitions Caused by the Underlying ORM">​</a></h3>
<p>Pointer property objects lay hidden risks for business logic processing, requiring developers to switch between pointers and properties in the code logic, especially since basic types often need to pass parameters by re-evaluation. If the input parameter is of <code>interface{}</code> type, it is easier to cause <code>BUG</code>.</p>
<p><img decoding=async loading=lazy src=/en/assets/images/620c8a9a4a47de0243748d588aa0bb51-7d237ccc764b58b03cb7d9c1e0e49d53.png width=2464 height=1730 class=img_ev3q></p>
<p><code>BUG</code> example, inappropriate use of pointer properties causing logical errors in address comparison.</p>
<p><img decoding=async loading=lazy src=/en/assets/images/daa08ad1e9102f4ac964a8176a80e061-867ac37ef33fa994f2f6af27c3fcc2c7.png width=2264 height=1716 class=img_ev3q></p>
<p>This also affects the design of business model structure definitions, leading developers to form incorrect habits (upper business model pointer properties often cater to the lower-level data table entity objects for convenient data transmission).</p>
<p><img decoding=async loading=lazy src=/en/assets/images/bba716ea66e03727826ae6401ce01b2d-d3b19578993ec7e5f59cc5025a0e5fb1.png width=2432 height=1730 class=img_ev3q></p>
<p>Notably, a common mistake is using the lower-level data entity model as the top-leve business model. This issue is particularly evident when pointer properties are used in the lower-level data entity objects.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=9-support-for-observability-tracing-metrics-logging>9. Support for Observability: Tracing, Metrics, Logging<a href=#9-support-for-observability-tracing-metrics-logging class=hash-link aria-label="Direct link to 9. Support for Observability: Tracing, Metrics, Logging" title="Direct link to 9. Support for Observability: Tracing, Metrics, Logging">​</a></h3>
<p>As the most critical core component of business projects, supporting observability is crucial.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id=10-data-set-and-code-data-entity-structure-mismatch>10. Data Set and Code Data Entity Structure Mismatch<a href=#10-data-set-and-code-data-entity-structure-mismatch class=hash-link aria-label="Direct link to 10. Data Set and Code Data Entity Structure Mismatch" title="Direct link to 10. Data Set and Code Data Entity Structure Mismatch">​</a></h3>
<p>When data entity structures are manually maintained, there is often a risk of inconsistency between data sets and code data entity structures, resulting in high development and maintenance costs.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id=3-improvement-design>3. Improvement Design<a href=#3-improvement-design class=hash-link aria-label="Direct link to 3. Improvement Design" title="Direct link to 3. Improvement Design">​</a></h2>
<ol>
<li>
<p>No special tag definitions needed for query result objects, fully automatic association mapping</p>
</li>
<li>
<p>Support automatic identification of query fields based on the specified object instead of all <code>SELECT *</code></p>
</li>
<li>
<p>Support automatic filtering of non-existent field contents based on the specified object</p>
</li>
<li>
<p>Use <code>DAO</code> object encapsulation code design, operating data tables via object methods</p>
</li>
<li>
<p><code>DAO</code> objects encapsulate associated table and field names to avoid string hardcoding</p>
</li>
<li>
<p>No need to predefine entity objects for receiving results, nor create intermediate entities for interface return object assignment and conversion</p>
</li>
<li>
<p>Query result objects are not pre-initialized, automatically created only when data is queried</p>
</li>
<li>
<p>Built-in support for <code>OpenTelemetry</code> standards, achieving observability, greatly improving maintenance efficiency, reducing costs</p>
</li>
<li>
<p>Support for <code>SQL</code> log output capabilities, with on/off switch functionality</p>
</li>
<li>
<p>Decoupling of data models, data operations, and business logic, supporting automated generation of <code>Dao</code> and <code>Model</code> code tools, ensuring consistency of data sets and code data structure, improving development efficiency, and facilitating the implementation of standards</p>
</li>
<li>
<p>Etc.</p>
</li>
</ol>
<p><img decoding=async loading=lazy src=/en/assets/images/90537635dc3b5623060fa9edfc49948a-6e0517950a26ea1562c25067f1c811ec.png width=2464 height=650 class=img_ev3q></p>
<p>Code example after improvement using <code>DAO</code> design</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class=col><a href=https://github.com/gogf/gf-site/blob/main/docs/docs/框架设计/工程开发设计/DAO封装设计/DAO-组件痛点及改进.md target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class=theme-last-updated>Last updated<!-- --> on <b><time datetime=2024-12-09T01:41:01.000Z itemprop=dateModified>Dec 9, 2024</time></b> by <b>John</b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/en/docs/design/project-dao><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>DAO Encapsulation</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/en/docs/design/project-dao-improvement><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Pain Points and Improvements In Business Project</div></a></nav><div class=docusaurus-mt-lg></div></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#1-current-orm-usage-example class="table-of-contents__link toc-highlight">1. Current <code>ORM</code> Usage Example</a><ul><li><a href=#1-need-to-define-models class="table-of-contents__link toc-highlight">1. Need to Define Models</a><li><a href=#2-grpc-interface-implementation-example class="table-of-contents__link toc-highlight">2. <code>GRPC</code> Interface Implementation Example</a></ul><li><a href=#2-description-of-current-pain-points class="table-of-contents__link toc-highlight">2. Description of Current Pain Points</a><ul><li><a href=#1-must-define-tag-to-associate-table-structure-with-struct-properties-cannot-achieve-automatic-mapping class="table-of-contents__link toc-highlight">1. Must Define <code>tag</code> to Associate Table Structure with <code>struct</code> Properties, Cannot Achieve Automatic Mapping</a><li><a href=#2-does-not-support-specifying-fields-to-query-via-the-return-object class="table-of-contents__link toc-highlight">2. Does Not Support Specifying Fields to Query via the Return Object</a><li><a href=#3-unable-to-automatically-filter-field-names-of-input-object-properties class="table-of-contents__link toc-highlight">3. Unable to Automatically Filter Field Names of Input Object Properties</a><li><a href=#4-need-to-create-intermediate-query-result-objects-for-assignment-and-conversion class="table-of-contents__link toc-highlight">4. Need to Create Intermediate Query Result Objects for Assignment and Conversion</a><li><a href=#5-need-to-pre-initialize-return-objects-regardless-of-whether-data-is-queried class="table-of-contents__link toc-highlight">5. Need to Pre-initialize Return Objects Regardless of Whether Data is Queried</a><li><a href=#6-entire-project-uses-low-level-bare-db-object-operations-without-object-encapsulation class="table-of-contents__link toc-highlight">6. Entire Project Uses Low-Level Bare <code>DB</code> Object Operations Without Object Encapsulation</a><li><a href=#7-ubiquitous-string-hardcoding-such-as-table-names-and-field-hardcoding class="table-of-contents__link toc-highlight">7. Ubiquitous String Hardcoding, such as Table Names and Field Hardcoding</a><li><a href=#8-too-many-pointer-property-definitions-caused-by-the-underlying-orm class="table-of-contents__link toc-highlight">8. Too Many Pointer Property Definitions Caused by the Underlying ORM</a><li><a href=#9-support-for-observability-tracing-metrics-logging class="table-of-contents__link toc-highlight">9. Support for Observability: Tracing, Metrics, Logging</a><li><a href=#10-data-set-and-code-data-entity-structure-mismatch class="table-of-contents__link toc-highlight">10. Data Set and Code Data Entity Structure Mismatch</a></ul><li><a href=#3-improvement-design class="table-of-contents__link toc-highlight">3. Improvement Design</a></ul></div></div></div></div></main></div></div></div><footer class=footer><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class=footer__title>Follow Us On WeChat</div><ul class="footer__items clean-list"><li class=footer__item><img src=/img/wechat.jpg width=110></ul></div></div><div class="footer__bottom text--center"><div class=footer__copyright>Copyright ©2024 GoFrame OpenSource Team</div></div></div></footer></div>