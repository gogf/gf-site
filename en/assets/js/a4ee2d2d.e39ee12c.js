"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["22271"],{626726:function(e,t,n){n.r(t),n.d(t,{metadata:()=>r,contentTitle:()=>o,default:()=>h,assets:()=>d,toc:()=>c,frontMatter:()=>a});var r=JSON.parse('{"id":"docs/WEB\u670D\u52A1\u5F00\u53D1/\u8BF7\u6C42\u8F93\u5165/\u8BF7\u6C42\u8F93\u5165-\u5BF9\u8C61\u5904\u7406","title":"Request - Parameter Binding","description":"This document details how to handle request parameter binding in the GoFrame framework. By binding request parameters to struct objects, it facilitates structured parameter handling. The document introduces default and custom parameter binding rules, and how to perform convenient parameter binding and data validation through the Parse method of the Request object.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/docs/WEB\u670D\u52A1\u5F00\u53D1/\u8BF7\u6C42\u8F93\u5165/\u8BF7\u6C42\u8F93\u5165-\u5BF9\u8C61\u5904\u7406.md","sourceDirName":"docs/WEB\u670D\u52A1\u5F00\u53D1/\u8BF7\u6C42\u8F93\u5165","slug":"/docs/web/request-struct-converting","permalink":"/en/docs/web/request-struct-converting","draft":false,"unlisted":false,"editUrl":"https://github.com/gogf/gf-site/blob/main/docs/docs/WEB\u670D\u52A1\u5F00\u53D1/\u8BF7\u6C42\u8F93\u5165/\u8BF7\u6C42\u8F93\u5165-\u5BF9\u8C61\u5904\u7406.md","tags":[],"version":"current","lastUpdatedBy":"John","lastUpdatedAt":1732598598000,"sidebarPosition":1,"frontMatter":{"slug":"/docs/web/request-struct-converting","title":"Request - Parameter Binding","sidebar_position":1,"hide_title":true,"keywords":["parameter binding","request parsing","struct binding","GoFrame framework","parameter mapping","custom binding","data validation","route registration","JSON response","Go language"],"description":"This document details how to handle request parameter binding in the GoFrame framework. By binding request parameters to struct objects, it facilitates structured parameter handling. The document introduces default and custom parameter binding rules, and how to perform convenient parameter binding and data validation through the Parse method of the Request object."},"sidebar":"mainSidebar","previous":{"title":"Request - Parameters","permalink":"/en/docs/web/request-parameters"},"next":{"title":"Request - Validation","permalink":"/en/docs/web/request-validation"}}'),s=n("785893"),i=n("250065");let a={slug:"/docs/web/request-struct-converting",title:"Request - Parameter Binding",sidebar_position:1,hide_title:!0,keywords:["parameter binding","request parsing","struct binding","GoFrame framework","parameter mapping","custom binding","data validation","route registration","JSON response","Go language"],description:"This document details how to handle request parameter binding in the GoFrame framework. By binding request parameters to struct objects, it facilitates structured parameter handling. The document introduces default and custom parameter binding rules, and how to perform convenient parameter binding and data validation through the Parse method of the Request object."},o=void 0,d={},c=[{value:"Parameter Binding",id:"parameter-binding",level:2},{value:"Parameter Mapping",id:"parameter-mapping",level:2},{value:"Default Rules",id:"default-rules",level:3},{value:"Custom Rules",id:"custom-rules",level:3},{value:"<code>Parse</code> Binding",id:"parse-binding",level:2}];function l(e){let t={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"parameter-binding",children:"Parameter Binding"}),"\n",(0,s.jsxs)(t.p,{children:["Parameter binding is a common requirement in request processing. We recommend binding request parameters to ",(0,s.jsx)(t.code,{children:"struct"})," objects for structured parameter handling. The ",(0,s.jsx)(t.code,{children:"GoFrame"})," framework provides convenient parameter binding capabilities, supporting binding of client-submitted parameters such as ",(0,s.jsx)(t.code,{children:"Query"})," parameters, form parameters, content parameters, ",(0,s.jsx)(t.code,{children:"JSON/XML"}),", etc., to specified ",(0,s.jsx)(t.code,{children:"struct"})," objects, and supports maintaining the mapping relationship between submitted parameters and ",(0,s.jsx)(t.code,{children:"struct"})," properties."]}),"\n",(0,s.jsxs)(t.p,{children:["Parameter binding methods use the ",(0,s.jsx)(t.code,{children:"Parse"})," method or ",(0,s.jsx)(t.code,{children:"Get*Struct"})," methods of the ",(0,s.jsx)(t.code,{children:"Request"})," object. For specific method definitions, please refer to the API documentation: ",(0,s.jsx)(t.a,{href:"https://pkg.go.dev/github.com/gogf/gf/v2/net/ghttp#Request",children:"https://pkg.go.dev/github.com/gogf/gf/v2/net/ghttp#Request"})]}),"\n",(0,s.jsx)(t.h2,{id:"parameter-mapping",children:"Parameter Mapping"}),"\n",(0,s.jsx)(t.h3,{id:"default-rules",children:"Default Rules"}),"\n",(0,s.jsxs)(t.p,{children:["When binding client-submitted parameters to server-defined ",(0,s.jsx)(t.code,{children:"struct"})," properties, you can use the default mapping rules, which is very convenient. The default binding rules are as follows:"]}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["Properties in the ",(0,s.jsx)(t.code,{children:"struct"})," that need to be bound must be ",(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"public properties"})})," (first letter capitalized)."]}),"\n",(0,s.jsxs)(t.li,{children:["Parameter names will automatically match with ",(0,s.jsx)(t.code,{children:"struct"})," properties in a ",(0,s.jsx)(t.strong,{children:(0,s.jsx)(t.code,{children:"case-insensitive"})})," manner and ",(0,s.jsxs)(t.strong,{children:["ignoring ",(0,s.jsx)(t.code,{children:"-/_/space"})," symbols"]}),"."]}),"\n",(0,s.jsx)(t.li,{children:"If the match is successful, the parameter value will be bound to the property; if it cannot be matched, the parameter will be ignored."}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Here are some matching examples:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-html",children:"map key name  struct property  Match?\nname         Name             match\nEmail        Email            match\nnickname     NickName         match\nNICKNAME     NickName         match\nNick-Name    NickName         match\nnick_name    NickName         match\nnick name    NickName         match\nNickName     Nick_Name        match\nNick-name    Nick_Name        match\nnick_name    Nick_Name        match\nnick name    Nick_Name        match\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Since the underlying parameter binding implementation uses the ",(0,s.jsx)(t.code,{children:"gconv"})," module, it also supports ",(0,s.jsx)(t.code,{children:"c/gconv/json"})," tags. For more detailed rules, please refer to the ",(0,s.jsx)(t.a,{href:"/en/docs/core/gconv-struct",children:"Type Conversion - Struct"})," chapter."]}),"\n",(0,s.jsx)(t.h3,{id:"custom-rules",children:"Custom Rules"}),"\n",(0,s.jsx)(t.p,{children:"Please use custom binding rules in business scenarios where struct properties and parameter names differ significantly; otherwise, use the default parameter binding rules. This is because a large number of custom rule tags will increase code maintenance costs."}),"\n",(0,s.jsxs)(t.p,{children:["Custom parameter binding rules can be implemented by binding ",(0,s.jsx)(t.code,{children:"tags"})," to ",(0,s.jsx)(t.code,{children:"struct"})," properties. The ",(0,s.jsx)(t.code,{children:"tag"})," names can be ",(0,s.jsx)(t.code,{children:"p/param/params"}),". For example:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-go",children:'type User struct{\n    Id    int\n    Name  string\n    Pass1 string `p:"password1"`\n    Pass2 string `p:"password2"`\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["Here we use the ",(0,s.jsx)(t.code,{children:"p"})," tag to specify which parameter should bind to which property. The ",(0,s.jsx)(t.code,{children:"password1"})," parameter will bind to the ",(0,s.jsx)(t.code,{children:"Pass1"})," property, and ",(0,s.jsx)(t.code,{children:"password2"})," will bind to the ",(0,s.jsx)(t.code,{children:"Pass2"})," property. Other properties can use the default binding rules without setting ",(0,s.jsx)(t.code,{children:"tags"}),"."]}),"\n",(0,s.jsxs)(t.h2,{id:"parse-binding",children:[(0,s.jsx)(t.code,{children:"Parse"})," Binding"]}),"\n",(0,s.jsxs)(t.p,{children:["We can use the ",(0,s.jsx)(t.code,{children:"Parse"})," method to implement parameter binding to structs. This method is a convenient method that will automatically perform binding and data validation internally, but if there are no validation ",(0,s.jsx)(t.code,{children:"tags"})," bound in the ",(0,s.jsx)(t.code,{children:"struct"}),", validation logic will not be executed."]}),"\n",(0,s.jsx)(t.admonition,{type:"warning",children:(0,s.jsxs)(t.p,{children:["Starting from ",(0,s.jsx)(t.code,{children:"GoFrame v2"}),", we recommend using a structured approach to define routing methods for easier management of request/response structures and their parameter binding. Please refer to: ",(0,s.jsx)(t.a,{href:"/en/docs/web/router-registering-strict-router",children:"Standard Router"})]})}),"\n",(0,s.jsx)(t.p,{children:"Usage example:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-go",children:'package main\n\nimport (\n    "github.com/gogf/gf/v2/frame/g"\n    "github.com/gogf/gf/v2/net/ghttp"\n)\n\ntype RegisterReq struct {\n    Name  string\n    Pass  string `p:"password1"`\n    Pass2 string `p:"password2"`\n}\n\ntype RegisterRes struct {\n    Code  int         `json:"code"`\n    Error string      `json:"error"`\n    Data  interface{} `json:"data"`\n}\n\nfunc main() {\n    s := g.Server()\n    s.BindHandler("/register", func(r *ghttp.Request) {\n        var req *RegisterReq\n        if err := r.Parse(&req); err != nil {\n            r.Response.WriteJsonExit(RegisterRes{\n                Code:  1,\n                Error: err.Error(),\n            })\n        }\n        // ...\n        r.Response.WriteJsonExit(RegisterRes{\n            Data: req,\n        })\n    })\n    s.SetPort(8199)\n    s.Run()\n}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["In this example, we defined two structs: ",(0,s.jsx)(t.code,{children:"RegisterReq"})," for binding request parameters and ",(0,s.jsx)(t.code,{children:"RegisterRes"})," for response data."]}),"\n",(0,s.jsxs)(t.p,{children:["We use ",(0,s.jsx)(t.code,{children:"r.Parse(&req)"})," to bind client-submitted parameters to a ",(0,s.jsx)(t.code,{children:"RegisterReq"})," object. When the binding is successful, the ",(0,s.jsx)(t.code,{children:"req"})," variable will be initialized with the bound values (by default it's ",(0,s.jsx)(t.code,{children:"nil"}),"), otherwise, this method returns ",(0,s.jsx)(t.code,{children:"err"})," and the ",(0,s.jsx)(t.code,{children:"req"})," variable remains ",(0,s.jsx)(t.code,{children:"nil"}),". The response data structure is defined through ",(0,s.jsx)(t.code,{children:"RegisterRes"}),", and the return format is ",(0,s.jsx)(t.code,{children:"JSON"}),", implemented through ",(0,s.jsx)(t.code,{children:"r.Response.WriteJsonExit"}),". This method converts ",(0,s.jsx)(t.code,{children:"RegisterRes"})," to ",(0,s.jsx)(t.code,{children:"JSON"})," format according to its internal defined ",(0,s.jsx)(t.code,{children:"json"})," tags and exits the current service method."]}),"\n",(0,s.jsxs)(t.p,{children:["To demonstrate the binding effect, here we return the ",(0,s.jsx)(t.code,{children:"RegisterReq"})," object in the normal return result's ",(0,s.jsx)(t.code,{children:"Data"})," property. Since this object doesn't have ",(0,s.jsx)(t.code,{children:"json"})," tags bound, the returned ",(0,s.jsx)(t.code,{children:"JSON"})," fields will be its property names."]}),"\n",(0,s.jsxs)(t.p,{children:["Let's test it with the ",(0,s.jsx)(t.code,{children:"curl"})," tool:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:'$ curl "http://127.0.0.1:8199/register?name=john&password1=123&password2=456"\n{"code":0,"error":"","data":{"Name":"john","Pass":"123","Pass2":"456"}}\n\n$ curl -d "name=john&password1=123&password2=456" -X POST "http://127.0.0.1:8199/register"\n{"code":0,"error":"","data":{"Name":"john","Pass":"123","Pass2":"456"}}\n'})}),"\n",(0,s.jsxs)(t.p,{children:["We used both ",(0,s.jsx)(t.code,{children:"GET"})," and ",(0,s.jsx)(t.code,{children:"POST"})," submission methods for testing, and we can see that the server can perfectly bind the submitted parameters to the struct object."]})]})}function h(e={}){let{wrapper:t}={...(0,i.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},250065:function(e,t,n){n.d(t,{Z:function(){return o},a:function(){return a}});var r=n(667294);let s={},i=r.createContext(s);function a(e){let t=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),r.createElement(i.Provider,{value:t},e.children)}}}]);