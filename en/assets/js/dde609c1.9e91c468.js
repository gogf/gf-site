"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["25761"],{411466:function(e,n,t){t.r(n),t.d(n,{metadata:()=>o,contentTitle:()=>s,default:()=>h,assets:()=>c,toc:()=>d,frontMatter:()=>r});var o=JSON.parse('{"id":"docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM/ORM\u4E8B\u52A1\u5904\u7406/ORM\u4E8B\u52A1\u5904\u7406-\u5E38\u89C4\u64CD\u4F5C","title":"ORM Transaction - Methods","description":"Basic operations for ORM transaction handling in the GoFrame framework, including how to use the Begin, Commit, and Rollback methods to start, commit, and rollback transactions. It is particularly important to close transactions promptly after use to avoid resource leaks, and it is recommended to use the Transaction closure method for safe transaction operations.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM/ORM\u4E8B\u52A1\u5904\u7406/ORM\u4E8B\u52A1\u5904\u7406-\u5E38\u89C4\u64CD\u4F5C.md","sourceDirName":"docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM/ORM\u4E8B\u52A1\u5904\u7406","slug":"/docs/core/gdb-transaction-basic","permalink":"/en/docs/core/gdb-transaction-basic","draft":false,"unlisted":false,"editUrl":"https://github.com/gogf/gf-site/blob/main/docs/docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM/ORM\u4E8B\u52A1\u5904\u7406/ORM\u4E8B\u52A1\u5904\u7406-\u5E38\u89C4\u64CD\u4F5C.md","tags":[],"version":"current","lastUpdatedBy":"John","lastUpdatedAt":1732541616000,"sidebarPosition":0,"frontMatter":{"slug":"/docs/core/gdb-transaction-basic","title":"ORM Transaction - Methods","sidebar_position":0,"hide_title":true,"keywords":["transaction operations","Begin","Commit","Rollback","GoFrame","database operations","Transaction","closure method","gdb.Tx","chain operations"],"description":"Basic operations for ORM transaction handling in the GoFrame framework, including how to use the Begin, Commit, and Rollback methods to start, commit, and rollback transactions. It is particularly important to close transactions promptly after use to avoid resource leaks, and it is recommended to use the Transaction closure method for safe transaction operations."},"sidebar":"mainSidebar","previous":{"title":"ORM - Transaction","permalink":"/en/docs/core/gdb-transaction"},"next":{"title":"ORM Transaction - Closure","permalink":"/en/docs/core/gdb-transaction-closure"}}'),a=t("785893"),i=t("250065");let r={slug:"/docs/core/gdb-transaction-basic",title:"ORM Transaction - Methods",sidebar_position:0,hide_title:!0,keywords:["transaction operations","Begin","Commit","Rollback","GoFrame","database operations","Transaction","closure method","gdb.Tx","chain operations"],description:"Basic operations for ORM transaction handling in the GoFrame framework, including how to use the Begin, Commit, and Rollback methods to start, commit, and rollback transactions. It is particularly important to close transactions promptly after use to avoid resource leaks, and it is recommended to use the Transaction closure method for safe transaction operations."},s=void 0,c={},d=[{value:"1. Initiating a Transaction",id:"1-initiating-a-transaction",level:2},{value:"2. Transaction Rollback Operation",id:"2-transaction-rollback-operation",level:2},{value:"3. Transaction Commit Operation",id:"3-transaction-commit-operation",level:2},{value:"4. Transaction Chain Operations",id:"4-transaction-chain-operations",level:2}];function l(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(n.p,{children:["The usual transaction operation methods are ",(0,a.jsx)(n.code,{children:"Begin/Commit/Rollback"}),", with each method specifying a specific transaction operation. A transaction operation can be initiated by executing the ",(0,a.jsx)(n.code,{children:"db.Begin"})," method, which returns an interface for transaction operations, with the type ",(0,a.jsx)(n.code,{children:"gdb.Tx"}),". You can perform subsequent database operations through this object, and you can submit changes with ",(0,a.jsx)(n.code,{children:"tx.Commit"})," or rollback changes with ",(0,a.jsx)(n.code,{children:"tx.Rollback"}),"."]}),"\n",(0,a.jsx)(n.admonition,{type:"warning",children:(0,a.jsxs)(n.p,{children:["Common Issues to Note: After initiating a transaction operation, be sure to close the transaction when no longer needed using ",(0,a.jsx)(n.code,{children:"Commit"}),"/",(0,a.jsx)(n.code,{children:"Rollback"})," operations. It is advisable to make good use of the ",(0,a.jsx)(n.code,{children:"defer"})," method. If the transaction is not closed after use, it can lead to uncontrolled growth in goroutines on the application side and saturation of transaction threads on the database side, causing subsequent transaction requests to timeout. Furthermore, it is recommended to use the ",(0,a.jsx)(n.code,{children:"Transaction"})," closure method introduced later for safely implementing transaction operations: ",(0,a.jsx)(n.a,{href:"/en/docs/core/gdb-transaction-closure",children:"ORM Transaction - Closure"})]})}),"\n",(0,a.jsx)(n.h2,{id:"1-initiating-a-transaction",children:"1. Initiating a Transaction"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-go",children:'db := g.DB()\n\nif tx, err := db.Begin(ctx); err == nil {\n    fmt.Println("Initiating a transaction")\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["The transaction operation object can perform all methods of the ",(0,a.jsx)(n.code,{children:"db"})," object. For more details, please refer to the ",(0,a.jsx)(n.a,{href:"https://pkg.go.dev/github.com/gogf/gf/v2/database/gdb",children:"API documentation"}),"."]}),"\n",(0,a.jsx)(n.h2,{id:"2-transaction-rollback-operation",children:"2. Transaction Rollback Operation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-go",children:'if tx, err := db.Begin(ctx); err == nil {\n    r, err := tx.Save("user", g.Map{\n        "id"   :  1,\n        "name" : "john",\n    })\n    if err != nil {\n        tx.Rollback()\n    }\n    fmt.Println(r)\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"3-transaction-commit-operation",children:"3. Transaction Commit Operation"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-go",children:'if tx, err := db.Begin(ctx); err == nil {\n    r, err := tx.Save("user", g.Map{\n        "id"   :  1,\n        "name" : "john",\n    })\n    if err == nil {\n       tx.Commit()\n    }\n    fmt.Println(r)\n}\n'})}),"\n",(0,a.jsx)(n.h2,{id:"4-transaction-chain-operations",children:"4. Transaction Chain Operations"}),"\n",(0,a.jsxs)(n.p,{children:["The transaction operation object can still return a chain operation object via the ",(0,a.jsx)(n.code,{children:"tx.Model"})," method. This object is the same as the one returned by the ",(0,a.jsx)(n.code,{children:"db.Model"})," method, except that database operations are performed on the transaction and can be committed or rolled back."]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-go",children:'if tx, err := db.Begin(); err == nil {\n    r, err := tx.Model("user").Data(g.Map{"id":1, "name": "john_1"}).Save()\n    if err == nil {\n       tx.Commit()\n    }\n    fmt.Println(r)\n}\n'})}),"\n",(0,a.jsxs)(n.p,{children:["For other chain operations, please refer to the ",(0,a.jsx)(n.a,{href:"/en/docs/core/gdb-chaining",children:"ORM - Model \uD83D\uDD25"})," section."]})]})}function h(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},250065:function(e,n,t){t.d(n,{Z:function(){return s},a:function(){return r}});var o=t(667294);let a={},i=o.createContext(a);function r(e){let n=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);