"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["6405"],{310387:function(e,n,t){t.r(n),t.d(n,{metadata:()=>o,contentTitle:()=>s,default:()=>h,assets:()=>d,toc:()=>c,frontMatter:()=>r});var o=JSON.parse('{"id":"quick/\u9879\u76EE\u811A\u624B\u67B6/\u63A5\u53E3\u5F00\u53D1/Step2 - \u751F\u6210dao_do_entity","title":"Step2 - Generate dao/do/entity","description":"Use the scaffolding tool in the GoFrame framework for automated data access object generation, ensure the CLI tool is configured correctly, then execute the code generation through commands, and generate corresponding dao, do, and entity files after creating the database tables to simplify CRUD operations. It demonstrates the specific file structure and usage, as well as the principles of generating different types of files.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/quick/\u9879\u76EE\u811A\u624B\u67B6/\u63A5\u53E3\u5F00\u53D1/Step2 - \u751F\u6210dao_do_entity.md","sourceDirName":"quick/\u9879\u76EE\u811A\u624B\u67B6/\u63A5\u53E3\u5F00\u53D1","slug":"/quick/scaffold-api-gen-dao","permalink":"/en/quick/scaffold-api-gen-dao","draft":false,"unlisted":false,"editUrl":"https://github.com/gogf/gf-site/blob/main/docs/quick/\u9879\u76EE\u811A\u624B\u67B6/\u63A5\u53E3\u5F00\u53D1/Step2 - \u751F\u6210dao_do_entity.md","tags":[],"version":"current","lastUpdatedBy":"John","lastUpdatedAt":1732541616000,"sidebarPosition":2,"frontMatter":{"slug":"/quick/scaffold-api-gen-dao","title":"Step2 - Generate dao/do/entity","hide_title":true,"sidebar_position":2,"keywords":["GoFrame","CLI Tool","Data Access Object","Automated Generation","Data Model","Database Configuration","Make Command","Data Transformation","Code Generation","ORM Component"],"description":"Use the scaffolding tool in the GoFrame framework for automated data access object generation, ensure the CLI tool is configured correctly, then execute the code generation through commands, and generate corresponding dao, do, and entity files after creating the database tables to simplify CRUD operations. It demonstrates the specific file structure and usage, as well as the principles of generating different types of files."},"sidebar":"quickSidebar","previous":{"title":"Step1 - Design Data Structure","permalink":"/en/quick/scaffold-api-sql"},"next":{"title":"Step3 - Write API Definition","permalink":"/en/quick/scaffold-api-definition"}}'),i=t("785893"),a=t("250065");let r={slug:"/quick/scaffold-api-gen-dao",title:"Step2 - Generate dao/do/entity",hide_title:!0,sidebar_position:2,keywords:["GoFrame","CLI Tool","Data Access Object","Automated Generation","Data Model","Database Configuration","Make Command","Data Transformation","Code Generation","ORM Component"],description:"Use the scaffolding tool in the GoFrame framework for automated data access object generation, ensure the CLI tool is configured correctly, then execute the code generation through commands, and generate corresponding dao, do, and entity files after creating the database tables to simplify CRUD operations. It demonstrates the specific file structure and usage, as well as the principles of generating different types of files."},s=void 0,d={},c=[{value:"CLI Tool Configuration",id:"cli-tool-configuration",level:2},{value:"Execute Code Generation",id:"execute-code-generation",level:2},{value:"dao",id:"dao",level:3},{value:"do",id:"do",level:3},{value:"entity",id:"entity",level:3},{value:"Learning Summary",id:"learning-summary",level:2}];function l(e){let n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"cli-tool-configuration",children:"CLI Tool Configuration"}),"\n",(0,i.jsxs)(n.p,{children:["Before using the scaffolding tool, please check whether the local ",(0,i.jsx)(n.code,{children:"cli"})," tool configuration is correct. The default configuration is as follows:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="hack/config.yaml"',children:'\n# CLI tool, only in development environment.\n# https://goframe.org/docs/cli\ngfcli:\n  gen:\n    dao:\n    - link: "mysql:root:12345678@tcp(127.0.0.1:3306)/test"\n      descriptionTag: true\n\n  docker:\n    build: "-a amd64 -s linux -p temp -ew"\n    tagPrefixes:\n    - my.image.pub/my-app\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"dao"})," section configuration is the configuration for the command to be executed this time, where ",(0,i.jsx)(n.code,{children:"link"})," is the database configuration required for connection. ",(0,i.jsx)(n.code,{children:"descriptionTag"})," indicates adding field descriptions to the ",(0,i.jsx)(n.code,{children:"description"})," tag in the generated ",(0,i.jsx)(n.code,{children:"entity"})," code file. If the ",(0,i.jsx)(n.code,{children:"entity"})," object of the data table is used in the API ",(0,i.jsx)(n.code,{children:"api"})," definition, this tag can serve as a parameter description. We need to change this ",(0,i.jsx)(n.code,{children:"link"})," configuration to our database connection address. For a detailed introduction to the ",(0,i.jsx)(n.code,{children:"link"})," configuration item, please refer to the section ",(0,i.jsx)(n.a,{href:"/en/docs/core/gdb-config-file",children:"ORM Configuration - File"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:["The ",(0,i.jsx)(n.code,{children:"docker"})," configuration item is a configuration template provided by default, used for image compilation. It is not explained in detail here, but those interested can refer to the development manual's relevant sections on development tools."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"execute-code-generation",children:"Execute Code Generation"}),"\n",(0,i.jsxs)(n.p,{children:["After creating the data tables, we execute ",(0,i.jsx)(n.code,{children:"make dao"})," in the project's root directory to automatically generate the corresponding ",(0,i.jsx)(n.code,{children:"dao/do/entity"})," files."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"$ make dao\ngenerated: /Users/john/Temp/demo/internal/dao/user.go\ngenerated: /Users/john/Temp/demo/internal/dao/internal/user.go\ngenerated: /Users/john/Temp/demo/internal/model/do/user.go\ngenerated: /Users/john/Temp/demo/internal/model/entity/user.go\ndone!\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"make"})," command is a directive provided by default under ",(0,i.jsx)(n.code,{children:"*nix"})," systems, including ",(0,i.jsx)(n.code,{children:"Linux/MacOS"}),". If on other systems such as ",(0,i.jsx)(n.code,{children:"Windows"}),", which do not support the ",(0,i.jsx)(n.code,{children:"make"})," command by default, you can use the ",(0,i.jsx)(n.code,{children:"gf gen dao"})," command as a replacement."]})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"goframe dao, do, entity",src:t(336514).Z+"",width:"3420",height:"2002"})}),"\n",(0,i.jsxs)(n.p,{children:["Each table will generate three types of ",(0,i.jsx)(n.code,{children:"Go"})," files:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"dao"}),": Access the underlying data source through object methods, implemented based on the ",(0,i.jsx)(n.code,{children:"ORM"})," component."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"do"}),": Data transformation model for converting business models to data models, maintained by the tool and cannot be modified by users. The tool will overwrite this directory each time code files are generated."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"entity"}),": Data model, maintained by the tool and cannot be modified by users. The tool will overwrite this directory each time code files are generated."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["For a more detailed introduction, please refer to the section ",(0,i.jsx)(n.a,{href:"/en/docs/cli/gen-dao",children:"Dao/Do/Entity Generating"})]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["The code generated by the scaffolding tool includes a top-level file comment. If the file comment contains the description ",(0,i.jsx)(n.code,{children:"Code generated and maintained by GoFrame CLI tool. DO NOT EDIT."}),", it means the file is maintained by the scaffolding tool and will be overwritten with each code generation."]})}),"\n",(0,i.jsx)(n.h3,{id:"dao",children:"dao"}),"\n",(0,i.jsxs)(n.p,{children:["Two ",(0,i.jsx)(n.code,{children:"dao"})," files are generated:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"internal/dao/internal/user.go"})," is used to wrap access to the data table ",(0,i.jsx)(n.code,{children:"user"}),". This file automatically generates some data structures and methods to simplify ",(0,i.jsx)(n.code,{children:"CRUD"})," operations on the data table. This file is overwritten each time it is generated and is automatically maintained by the development tools, so developers do not need to worry about it."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"internal/dao/user.go"})," is actually a further encapsulation of ",(0,i.jsx)(n.code,{children:"internal/dao/internal/user.go"}),", used for direct access by other modules. Developers can modify this file as desired or extend the capabilities of ",(0,i.jsx)(n.code,{children:"dao"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Since the generated ",(0,i.jsx)(n.code,{children:"internal/dao/internal/user.go"})," file is completely maintained by the development tools, we only need to care about this generated source file ",(0,i.jsx)(n.code,{children:"internal/dao/user.go"}),", and make any functional extensions if needed."]}),"\n",(0,i.jsxs)(n.p,{children:["Sample source code: ",(0,i.jsx)(n.a,{href:"https://github.com/gogf/quick-demo/blob/main/internal/dao/user.go",children:"https://github.com/gogf/quick-demo/blob/main/internal/dao/user.go"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",metastring:'title="internal/dao/user.go"',children:'// =================================================================================\n// This is auto-generated by GoFrame CLI tool only once. Fill this file as you wish.\n// =================================================================================\n\npackage dao\n\nimport (\n    "demo/internal/dao/internal"\n)\n\n// internalUserDao is internal type for wrapping internal DAO implements.\ntype internalUserDao = *internal.UserDao\n\n// userDao is the data access object for table user.\n// You can define custom methods on it to extend its functionality as you wish.\ntype userDao struct {\n    internalUserDao\n}\n\nvar (\n    // User is globally public accessible object for table user operations.\n    User = userDao{\n        internal.NewUserDao(),\n    }\n)\n\n// Fill with you ideas below.\n'})}),"\n",(0,i.jsx)(n.h3,{id:"do",children:"do"}),"\n",(0,i.jsxs)(n.p,{children:["Sample source code: ",(0,i.jsx)(n.a,{href:"https://github.com/gogf/quick-demo/blob/main/internal/model/do/user.go",children:"https://github.com/gogf/quick-demo/blob/main/internal/model/do/user.go"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",metastring:'title="internal/model/do/user.go"',children:'// =================================================================================\n// Code generated and maintained by GoFrame CLI tool. DO NOT EDIT.\n// =================================================================================\n\npackage do\n\nimport (\n    "github.com/gogf/gf/v2/frame/g"\n)\n\n// User is the golang structure of table user for DAO operations like Where/Data.\ntype User struct {\n    g.Meta `orm:"table:user, do:true"`\n    Id     interface{} // user id\n    Name   interface{} // user name\n    Status interface{} // user status\n    Age    interface{} // user age\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["The usage of the ",(0,i.jsx)(n.code,{children:"do"})," data transformation model will be demonstrated in subsequent code logic."]}),"\n",(0,i.jsx)(n.h3,{id:"entity",children:"entity"}),"\n",(0,i.jsxs)(n.p,{children:["Sample source code: ",(0,i.jsx)(n.a,{href:"https://github.com/gogf/quick-demo/blob/main/internal/model/entity/user.go",children:"https://github.com/gogf/quick-demo/blob/main/internal/model/entity/user.go"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",metastring:'title="internal/model/entity/user.go"',children:'// =================================================================================\n// Code generated and maintained by GoFrame CLI tool. DO NOT EDIT.\n// =================================================================================\n\npackage entity\n\n// User is the golang structure for table user.\ntype User struct {\n	Id     uint   `json:"id"     orm:"id"     description:"user id"`     // user id\n	Name   string `json:"name"   orm:"name"   description:"user name"`   // user name\n	Status int    `json:"status" orm:"status" description:"user status"` // user status\n	Age    uint   `json:"age"    orm:"age"    description:"user age"`    // user age\n}\n'})}),"\n",(0,i.jsxs)(n.p,{children:["We can see that this ",(0,i.jsx)(n.code,{children:"entity"})," data structure definition corresponds directly to the data table fields."]}),"\n",(0,i.jsx)(n.h2,{id:"learning-summary",children:"Learning Summary"}),"\n",(0,i.jsxs)(n.p,{children:["It can be felt that using the convenient scaffolding tools of the ",(0,i.jsx)(n.code,{children:"GoFrame"})," framework, we are liberated from some repetitive coding labor, greatly improving production efficiency. Operations on the database will become very simple."]}),"\n",(0,i.jsxs)(n.p,{children:["In the next step, we will design the ",(0,i.jsx)(n.code,{children:"CRUD"})," API, to see how to quickly define an API in the ",(0,i.jsx)(n.code,{children:"GoFrame"})," framework."]})]})}function h(e={}){let{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},336514:function(e,n,t){t.d(n,{Z:function(){return o}});let o=t.p+"assets/images/QQ_1731806701346-b70b959cf011d7121091eea7a931fa63.png"},250065:function(e,n,t){t.d(n,{Z:function(){return s},a:function(){return r}});var o=t(667294);let i={},a=o.createContext(i);function r(e){let n=o.useContext(a);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),o.createElement(a.Provider,{value:n},e.children)}}}]);