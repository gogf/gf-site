"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["48158"],{632353:function(e,i,n){n.r(i),n.d(i,{metadata:()=>t,contentTitle:()=>a,default:()=>h,assets:()=>d,toc:()=>c,frontMatter:()=>r});var t=JSON.parse('{"id":"docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM/ORM\u5E38\u89C1\u95EE\u9898","title":"ORM - FAQ","description":"Common issues that may be encountered while performing ORM operations with the GoFrame framework and their solutions, including connection errors caused by expired database connection pools, ineffective update and insert operations, inability to find database drivers, problems with query conditions having WHERE 0=1, and encoding issues with storing emojis in MySQL tables. Some configuration recommendations are also provided to optimize the experience.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM/ORM\u5E38\u89C1\u95EE\u9898.md","sourceDirName":"docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM","slug":"/docs/core/gdb-faq","permalink":"/en/docs/core/gdb-faq","draft":false,"unlisted":false,"editUrl":"https://github.com/gogf/gf-site/blob/main/docs/docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM/ORM\u5E38\u89C1\u95EE\u9898.md","tags":[],"version":"current","lastUpdatedBy":"John","lastUpdatedAt":1732541616000,"sidebarPosition":11,"frontMatter":{"slug":"/docs/core/gdb-faq","title":"ORM - FAQ","sidebar_position":11,"hide_title":true,"keywords":["ORM FAQ","GoFrame","GoFrame framework","database connection pool","MaxLifeTime","SQL query","database driver","debug log","empty array condition","character set settings"],"description":"Common issues that may be encountered while performing ORM operations with the GoFrame framework and their solutions, including connection errors caused by expired database connection pools, ineffective update and insert operations, inability to find database drivers, problems with query conditions having WHERE 0=1, and encoding issues with storing emojis in MySQL tables. Some configuration recommendations are also provided to optimize the experience."},"sidebar":"mainSidebar","previous":{"title":"Avoid Object Initialization and sql.ErrNoRows Judgment in Queries","permalink":"/en/docs/core/gdb-practice-avoid-object-initialization-and-sql-errnorows-error"},"next":{"title":"Caching","permalink":"/en/docs/core/gcache"}}'),o=n("785893"),s=n("250065");let r={slug:"/docs/core/gdb-faq",title:"ORM - FAQ",sidebar_position:11,hide_title:!0,keywords:["ORM FAQ","GoFrame","GoFrame framework","database connection pool","MaxLifeTime","SQL query","database driver","debug log","empty array condition","character set settings"],description:"Common issues that may be encountered while performing ORM operations with the GoFrame framework and their solutions, including connection errors caused by expired database connection pools, ineffective update and insert operations, inability to find database drivers, problems with query conditions having WHERE 0=1, and encoding issues with storing emojis in MySQL tables. Some configuration recommendations are also provided to optimize the experience."},a=void 0,d={},c=[{value:"<code>driver: bad connection</code>",id:"driver-bad-connection",level:2},{value:"<code>update/insert</code> operations ineffective",id:"updateinsert-operations-ineffective",level:2},{value:"<code>cannot find database driver for specified database type &quot;xxx&quot;, did you misspell type name &quot;xxx&quot; or forget importing the database driver?</code>",id:"cannot-find-database-driver-for-specified-database-type-xxx-did-you-misspell-type-name-xxx-or-forget-importing-the-database-driver",level:2},{value:"After enabling <code>DEBUG</code> log for the database, <code>SQL</code> statements show <code>WHERE 0=1</code>",id:"after-enabling-debug-log-for-the-database-sql-statements-show-where-01",level:2},{value:"Emoji storage in MYSQL tables results in encoding issues",id:"emoji-storage-in-mysql-tables-results-in-encoding-issues",level:2}];function l(e){let i={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.h2,{id:"driver-bad-connection",children:(0,o.jsx)(i.code,{children:"driver: bad connection"})}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.img,{src:n(391141).Z+"",width:"3440",height:"808"})}),"\n",(0,o.jsxs)(i.p,{children:["If this error occurs during database execution, it may be due to the local database connection pool connections having expired. You can check if the ",(0,o.jsx)(i.code,{children:"MaxLifeTime"})," configuration set on the client exceeds the maximum timeout set by the database server. For more client configurations, please refer to the section: ",(0,o.jsx)(i.a,{href:"/en/docs/core/gdb-config",children:"ORM - Configuration"})]}),"\n",(0,o.jsxs)(i.h2,{id:"updateinsert-operations-ineffective",children:[(0,o.jsx)(i.code,{children:"update/insert"})," operations ineffective"]}),"\n",(0,o.jsxs)(i.p,{children:["When using ",(0,o.jsx)(i.code,{children:"orm"}),", in the configuration file:"]}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-toml",children:'dryRun = "(optional) ORM dry run (read-only, no write)"\n'})}),"\n",(0,o.jsx)(i.p,{children:"This line of configuration must be deleted or set to 0"}),"\n",(0,o.jsxs)(i.p,{children:["Otherwise, ",(0,o.jsx)(i.code,{children:"update insert"})," operations will not be effective."]}),"\n",(0,o.jsx)(i.h2,{id:"cannot-find-database-driver-for-specified-database-type-xxx-did-you-misspell-type-name-xxx-or-forget-importing-the-database-driver",children:(0,o.jsx)(i.code,{children:'cannot find database driver for specified database type "xxx", did you misspell type name "xxx" or forget importing the database driver?'})}),"\n",(0,o.jsxs)(i.p,{children:["The program code has not included the dependent database driver. It is important to note that from ",(0,o.jsx)(i.code,{children:"GoFrame v2.1"})," onwards, community drivers need to be manually introduced. Please refer to:"]}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsx)(i.li,{children:(0,o.jsx)(i.a,{href:"https://github.com/gogf/gf/tree/master/contrib/drivers",children:"https://github.com/gogf/gf/tree/master/contrib/drivers"})}),"\n"]}),"\n",(0,o.jsxs)(i.h2,{id:"after-enabling-debug-log-for-the-database-sql-statements-show-where-01",children:["After enabling ",(0,o.jsx)(i.code,{children:"DEBUG"})," log for the database, ",(0,o.jsx)(i.code,{children:"SQL"})," statements show ",(0,o.jsx)(i.code,{children:"WHERE 0=1"})]}),"\n",(0,o.jsxs)(i.p,{children:["The occurrence of ",(0,o.jsx)(i.code,{children:"WHERE 0=1"})," happens due to the presence of an array condition in the query condition with an array length of ",(0,o.jsx)(i.code,{children:"0"}),". The ",(0,o.jsx)(i.code,{children:"ORM"})," cannot automatically filter out these empty array conditions (such filtering might cause business exceptions). Developers need to explicitly call ",(0,o.jsx)(i.code,{children:"OmitEmpty"})," or ",(0,o.jsx)(i.code,{children:"OmitEmptyWhere"})," based on the business scenario to instruct the ",(0,o.jsx)(i.code,{children:"ORM"})," to filter these empty array conditions."]}),"\n",(0,o.jsx)(i.h2,{id:"emoji-storage-in-mysql-tables-results-in-encoding-issues",children:"Emoji storage in MYSQL tables results in encoding issues"}),"\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.img,{src:n(40736).Z+"",width:"242",height:"87"})}),"\n",(0,o.jsx)(i.p,{children:"Solution:"}),"\n",(0,o.jsxs)(i.p,{children:["In the ",(0,o.jsx)(i.code,{children:"config.toml"})," file, set the database configuration ",(0,o.jsx)(i.code,{children:"charset"})," to ",(0,o.jsx)(i.code,{children:"utf8mb4"})," instead of the default ",(0,o.jsx)(i.code,{children:"utf8"}),"."]}),"\n",(0,o.jsxs)(i.p,{children:["When storing emojis in ",(0,o.jsx)(i.code,{children:"MySQL"}),", note the following:"]}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:["Database encoding is ",(0,o.jsx)(i.code,{children:"utf8mb4"})]}),"\n",(0,o.jsxs)(i.li,{children:["Table encoding is ",(0,o.jsx)(i.code,{children:"utf8mb4"})]}),"\n",(0,o.jsxs)(i.li,{children:["Content fields in the table are ",(0,o.jsx)(i.code,{children:"utf8mb4"})]}),"\n"]})]})}function h(e={}){let{wrapper:i}={...(0,s.a)(),...e.components};return i?(0,o.jsx)(i,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},391141:function(e,i,n){n.d(i,{Z:function(){return t}});let t=n.p+"assets/images/7b384b6f57115b11938d9c0a30dde732-2f9af306f3cbc5efe6a8eb12f1a5eb95.png"},40736:function(e,i,n){n.d(i,{Z:function(){return t}});let t=n.p+"assets/images/867e951b823bb2652a6b7d62f70a1ff3-81f4a16885143f2c2f2bcc8f52a64e10.png"},250065:function(e,i,n){n.d(i,{Z:function(){return a},a:function(){return r}});var t=n(667294);let o={},s=t.createContext(o);function r(e){let i=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),t.createElement(s.Provider,{value:i},e.children)}}}]);