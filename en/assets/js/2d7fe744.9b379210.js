"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["93270"],{60437:function(e,n,r){r.r(n),r.d(n,{metadata:()=>c,contentTitle:()=>s,default:()=>a,assets:()=>d,toc:()=>t,frontMatter:()=>i});var c=JSON.parse('{"id":"\u5FAE\u670D\u52A1\u5F00\u53D1/\u5FAE\u670D\u52A1\u5F00\u53D1","title":"\u5FAE\u670D\u52A1\u5F00\u53D1","description":"\u5FAE\u670D\u52A1\u5B8C\u6574\u7279\u6027\u53CA\u76F8\u5173\u7EC4\u4EF6\u4ECE v2.4 \u7248\u672C\u5F00\u59CB\u63D0\u4F9B\u3002","source":"@site/versioned_docs/version-2.6.x/\u5FAE\u670D\u52A1\u5F00\u53D1/\u5FAE\u670D\u52A1\u5F00\u53D1.md","sourceDirName":"\u5FAE\u670D\u52A1\u5F00\u53D1","slug":"/\u5FAE\u670D\u52A1\u5F00\u53D1/","permalink":"/en/2.6.x/\u5FAE\u670D\u52A1\u5F00\u53D1/","draft":false,"unlisted":false,"editUrl":"https://github.com/gogf/gf-site/blob/main/versioned_docs/version-2.6.x/\u5FAE\u670D\u52A1\u5F00\u53D1/\u5FAE\u670D\u52A1\u5F00\u53D1.md","tags":[],"version":"2.6.x","lastUpdatedBy":"John","lastUpdatedAt":1730365530000,"sidebarPosition":4,"frontMatter":{"title":"\u5FAE\u670D\u52A1\u5F00\u53D1","sidebar_position":4,"hide_title":true},"sidebar":"tutorialSidebar","previous":{"title":"\u9519\u8BEF\u7801\u63A5\u53E3-gcode","permalink":"/en/2.6.x/\u7EC4\u4EF6\u5217\u8868/\u9519\u8BEF\u7BA1\u7406/\u9519\u8BEF\u7801\u63A5\u53E3-gcode"},"next":{"title":"\u73AF\u5883\u51C6\u5907","permalink":"/en/2.6.x/\u5FAE\u670D\u52A1\u5F00\u53D1/\u73AF\u5883\u51C6\u5907"}}'),o=r("785893"),l=r("250065");let i={title:"\u5FAE\u670D\u52A1\u5F00\u53D1",sidebar_position:4,hide_title:!0},s=void 0,d={},t=[{value:"\u57FA\u672C\u4ECB\u7ECD",id:"\u57FA\u672C\u4ECB\u7ECD",level:2},{value:"\u7B80\u5355\u793A\u4F8B",id:"\u7B80\u5355\u793A\u4F8B",level:2},{value:"<code>HTTP</code> \u5FAE\u670D\u52A1\u793A\u4F8B",id:"http-\u5FAE\u670D\u52A1\u793A\u4F8B",level:3},{value:"<code>server.go</code>",id:"servergo",level:4},{value:"<code>client.go</code>",id:"clientgo",level:4},{value:"\u6267\u884C\u7ED3\u679C",id:"\u6267\u884C\u7ED3\u679C",level:4},{value:"<code>GRPC</code> \u5FAE\u670D\u52A1\u793A\u4F8B",id:"grpc-\u5FAE\u670D\u52A1\u793A\u4F8B",level:3},{value:"<code>helloworld.proto</code>",id:"helloworldproto",level:4},{value:"<code>controller.go</code>",id:"controllergo",level:4},{value:"<code>config.yaml</code>",id:"configyaml",level:4},{value:"<code>server.go</code>",id:"servergo-1",level:4},{value:"<code>client.go</code>",id:"clientgo-1",level:4},{value:"\u6267\u884C\u7ED3\u679C",id:"\u6267\u884C\u7ED3\u679C-1",level:4}];function g(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",...(0,l.a)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["\u5FAE\u670D\u52A1\u5B8C\u6574\u7279\u6027\u53CA\u76F8\u5173\u7EC4\u4EF6\u4ECE ",(0,o.jsx)(n.code,{children:"v2.4"})," \u7248\u672C\u5F00\u59CB\u63D0\u4F9B\u3002"]}),"\n",(0,o.jsx)(n.h2,{id:"\u57FA\u672C\u4ECB\u7ECD",children:"\u57FA\u672C\u4ECB\u7ECD"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"GoFrame"})," \u6846\u67B6\u652F\u6301\u5FAE\u670D\u52A1\u6A21\u5F0F\u5F00\u53D1\uFF0C\u63D0\u4F9B\u4E86\u5E38\u7528\u7684\u5FAE\u670D\u52A1\u7EC4\u4EF6\u3001\u5F00\u53D1\u5DE5\u5177\u3001\u5F00\u53D1\u6559\u7A0B\u5E2E\u52A9\u56E2\u961F\u5FEB\u901F\u5FAE\u670D\u52A1\u8F6C\u578B\u3002"]}),"\n",(0,o.jsx)(n.h2,{id:"\u7B80\u5355\u793A\u4F8B",children:"\u7B80\u5355\u793A\u4F8B"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"GoFrame"})," \u5FAE\u670D\u52A1\u7EC4\u4EF6\u7684\u4F4E\u85D5\u53CA\u901A\u7528\u5316\u8BBE\u8BA1\u7684\uFF0C\u7EC4\u4EF6\u5316\u4F7F\u7528\u652F\u6301\u5927\u90E8\u5206\u7684\u5FAE\u670D\u52A1\u901A\u4FE1\u534F\u8BAE\u3002\u5728\u5B98\u65B9\u6587\u6863\u4E2D\uFF0C\u6211\u4EEC\u4EE5 ",(0,o.jsx)(n.code,{children:"HTTP"})," \u53CA ",(0,o.jsx)(n.code,{children:"GRPC"})," \u534F\u8BAE\u4E3A\u793A\u4F8B\uFF0C\u4ECB\u7ECD\u5FAE\u670D\u52A1\u7684\u5F00\u53D1\u4EE5\u53CA\u7EC4\u4EF6\u5DE5\u5177\u7684\u4F7F\u7528\u3002\u7531\u4E8E ",(0,o.jsx)(n.code,{children:"HTTP Web"})," \u5F00\u53D1\u5DF2\u7ECF\u6709\u6BD4\u8F83\u4E30\u5BCC\u5B8C\u5584\u7684\u72EC\u7ACB\u7AE0\u8282\u4ECB\u7ECD\uFF0C\u56E0\u6B64\u5FAE\u670D\u52A1\u7AE0\u8282\u5927\u90E8\u5206\u4ECB\u7ECD\u4EE5 ",(0,o.jsx)(n.code,{children:"GRPC"})," \u4E3A\u4E3B\u3002"]}),"\n",(0,o.jsxs)(n.h3,{id:"http-\u5FAE\u670D\u52A1\u793A\u4F8B",children:[(0,o.jsx)(n.code,{children:"HTTP"})," \u5FAE\u670D\u52A1\u793A\u4F8B"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"https://github.com/gogf/gf/tree/master/example/registry/file",children:"https://github.com/gogf/gf/tree/master/example/registry/file"})}),"\n",(0,o.jsx)(n.h4,{id:"servergo",children:(0,o.jsx)(n.code,{children:"server.go"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n    "github.com/gogf/gf/contrib/registry/file/v2"\n    "github.com/gogf/gf/v2/frame/g"\n    "github.com/gogf/gf/v2/net/ghttp"\n    "github.com/gogf/gf/v2/net/gsvc"\n    "github.com/gogf/gf/v2/os/gfile"\n)\n\nfunc main() {\n    gsvc.SetRegistry(file.New(gfile.Temp("gsvc")))\n\n    s := g.Server(`hello.svc`)\n    s.BindHandler("/", func(r *ghttp.Request) {\n        g.Log().Info(r.Context(), `request received`)\n        r.Response.Write(`Hello world`)\n    })\n    s.Run()\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u53EF\u4EE5\u770B\u5230\uFF0C\u4E00\u4E2A ",(0,o.jsx)(n.code,{children:"HTTP"})," \u7684\u5FAE\u670D\u52A1\u7AEF\u548C\u4E00\u4E2A\u666E\u901A\u7684 ",(0,o.jsx)(n.code,{children:"Web Server"})," \u7AEF\u6CA1\u4EC0\u4E48\u5DEE\u5F02\uFF0C\u4F46\u662F\u9876\u90E8\u591A\u4E86\u4E00\u884C\u4EE3\u7801\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'gsvc.SetRegistry(file.New(gfile.Temp("gsvc")))\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u8FD9\u884C\u4EE3\u7801\u7528\u4E8E\u542F\u7528\u5E76\u6CE8\u518C\u5F53\u524D\u670D\u52A1\u4F7F\u7528\u7684\u6CE8\u518C\u53D1\u73B0\u7EC4\u4EF6\uFF0C\u5728\u8BE5\u793A\u4F8B\u4E2D\u4F7F\u7528\u7684 ",(0,o.jsx)(n.code,{children:'file.New(gfile.Temp("gsvc"))'})," \u662F\u57FA\u4E8E\u672C\u5730\u7CFB\u7EDF\u6587\u4EF6\u7684\u670D\u52A1\u6CE8\u518C\u53D1\u73B0\u7EC4\u4EF6\uFF0C\u5176\u4E2D\u7684 ",(0,o.jsx)(n.code,{children:'gfile.Temp("gsvc")'})," \u6307\u5B9A\u7684\u662F\u5B58\u653E\u670D\u52A1\u6587\u4EF6\u7684\u8DEF\u5F84\uFF0C\u4F8B\u5982\u5728 ",(0,o.jsx)(n.code,{children:"Linux/MacOS"})," \u7CFB\u7EDF\u4E0B\uFF0C\u6307\u5411\u7684\u662F ",(0,o.jsx)(n.code,{children:"/tmp/gsvc"})," \u76EE\u5F55\u3002\u57FA\u4E8E\u6587\u4EF6\u7CFB\u7EDF\u7684\u6CE8\u518C\u53D1\u73B0\u4EC5\u7528\u4E8E\u672C\u5730\u5FAE\u670D\u52A1\u793A\u4F8B\uFF0C\u4E0D\u80FD\u7528\u4E8E\u8DE8\u8282\u70B9\u901A\u4FE1\u3002\u5728\u751F\u4EA7\u73AF\u5883\u65F6\uFF0C\u6211\u4EEC\u5F80\u5F80\u4F1A\u4F7F\u7528\u5176\u4ED6\u7684\u670D\u52A1\u6CE8\u518C\u53D1\u73B0\u7EC4\u4EF6\uFF0C\u4F8B\u5982 ",(0,o.jsx)(n.code,{children:"etcd, polaris, zookeeper"})," \u7B49\uFF0C\u6846\u67B6\u7684\u793E\u533A\u7EC4\u4EF6\u4E2D\u5DF2\u7ECF\u63D0\u4F9B\u4E86\u5E38\u7528\u7684\u670D\u52A1\u6CE8\u518C\u53D1\u73B0\u7EC4\u4EF6\u7684\u5B9E\u73B0\u3002"]}),"\n",(0,o.jsxs)(n.p,{children:["\u5176\u6B21\uFF0C\u5728\u8BE5\u793A\u4F8B\u4E2D\uFF0C\u6211\u4EEC\u7ED9 ",(0,o.jsx)(n.code,{children:"Server"})," \u8BBE\u7F6E\u4E86\u4E00\u4E2A\u540D\u5B57 ",(0,o.jsx)(n.code,{children:"hello.svc"}),"\uFF0C\u8BE5\u540D\u5B57\u8868\u793A\u8BE5 ",(0,o.jsx)(n.code,{children:"Server"})," \u7ED1\u5B9A\u7684\u5FAE\u670D\u52A1\u7684\u540D\u79F0\uFF0C\u670D\u52A1\u540D\u79F0\u4F5C\u4E3A\u5FAE\u670D\u52A1\u7684\u552F\u4E00\u6807\u8BC6\uFF0C\u7528\u4E8E\u670D\u52A1\u95F4\u7684\u8BC6\u522B\u901A\u4FE1\u3002\u5F53\u670D\u52A1\u6CE8\u518C\u7EC4\u4EF6\u6CE8\u518C\u542F\u7528\u65F6\uFF0C ",(0,o.jsx)(n.code,{children:"HTTP Server"})," \u5728\u8FD0\u884C\u65F6\u5C06\u4F1A\u628A\u81EA\u5DF1\u7684\u8BBF\u95EE\u5730\u5740\u6CE8\u518C\u5230\u670D\u52A1\u6CE8\u518C\u7EC4\u4EF6\u4E2D\uFF0C\u65B9\u4FBF\u5176\u4ED6\u670D\u52A1\u901A\u8FC7\u76F8\u540C\u7EC4\u4EF6\u6309\u7167\u670D\u52A1\u540D\u79F0\u8FDB\u884C\u8BBF\u95EE\u3002"]}),"\n",(0,o.jsx)(n.h4,{id:"clientgo",children:(0,o.jsx)(n.code,{children:"client.go"})}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n    "time"\n\n    "github.com/gogf/gf/contrib/registry/file/v2"\n    "github.com/gogf/gf/v2/frame/g"\n    "github.com/gogf/gf/v2/net/gsvc"\n    "github.com/gogf/gf/v2/os/gctx"\n    "github.com/gogf/gf/v2/os/gfile"\n)\n\nfunc main() {\n    gsvc.SetRegistry(file.New(gfile.Temp("gsvc")))\n\n    client := g.Client()\n    for i := 0; i < 10; i++ {\n        ctx := gctx.New()\n        res, err := client.Get(ctx, `http://hello.svc/`)\n        if err != nil {\n            panic(err)\n        }\n        g.Log().Debug(ctx, res.ReadAllString())\n        res.Close()\n        time.Sleep(time.Second)\n    }\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u5BA2\u6237\u7AEF\u901A\u8FC7 ",(0,o.jsx)(n.code,{children:"g.Client()"})," \u521B\u5EFA\u4E00\u4E2A ",(0,o.jsx)(n.code,{children:"HTTP Client"}),"\uFF0C\u5E76\u901A\u8FC7 ",(0,o.jsx)(n.code,{children:"http://hello.svc/"})," \u5730\u5740\u8BBF\u95EE\u670D\u52A1\u7AEF\uFF0C\u5176\u4E2D\u7684 ",(0,o.jsx)(n.code,{children:"hello.svc"})," \u5373\u5148\u524D\u7684 ",(0,o.jsx)(n.code,{children:"Server"})," \u7AEF\u7ED1\u5B9A\u7684\u5FAE\u670D\u52A1\u540D\u79F0\u3002\u5F53\u5BA2\u6237\u7AEF\u901A\u8FC7\u5FAE\u670D\u52A1\u540D\u79F0\u8BBF\u95EE\u7684\u65F6\u5019\uFF0C\u670D\u52A1\u6CE8\u518C\u53D1\u73B0\u7EC4\u4EF6\u5C06\u4F1A\u5728\u5E95\u5C42\u8FDB\u884C\u68C0\u7D22\uFF0C\u5E76\u627E\u5230\u5BF9\u5E94\u7684\u670D\u52A1\u7AEF\u5730\u5740\u8FDB\u884C\u901A\u4FE1\u3002"]}),"\n",(0,o.jsx)(n.h4,{id:"\u6267\u884C\u7ED3\u679C",children:"\u6267\u884C\u7ED3\u679C"}),"\n",(0,o.jsxs)(n.p,{children:["\u5148\u6267\u884C ",(0,o.jsx)(n.code,{children:"server.go"})," \u670D\u52A1\u7AEF\u8FD0\u884C\u4E00\u4E2A\u7B80\u5355\u7684\u670D\u52A1\uFF0C\u968F\u540E\u518D\u6267\u884C ",(0,o.jsx)(n.code,{children:"client.go"})," \u901A\u8FC7\u670D\u52A1\u540D\u79F0\u8BF7\u6C42\u670D\u52A1\u3002"]}),"\n",(0,o.jsx)(n.p,{children:"\u6267\u884C\u540E\uFF0C\u5BA2\u6237\u7AEF\u8F93\u51FA\uFF1A"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ go run client.go\n2023-03-14 20:22:10.006 [DEBU] {8054f3a48c484c1760fb416bb3df20a4} Hello world\n2023-03-14 20:22:11.007 [DEBU] {6831cae08c484c1761fb416b9d4df851} Hello world\n2023-03-14 20:22:12.008 [DEBU] {9035761c8d484c1762fb416b1e648b81} Hello world\n2023-03-14 20:22:13.011 [DEBU] {a05a32588d484c1763fb416bc19ff667} Hello world\n2023-03-14 20:22:14.012 [DEBU] {40fdea938d484c1764fb416b8459fc43} Hello world\n2023-03-14 20:22:15.014 [DEBU] {686c9acf8d484c1765fb416b3697d369} Hello world\n2023-03-14 20:22:16.015 [DEBU] {906a470b8e484c1766fb416b85b9867e} Hello world\n2023-03-14 20:22:17.017 [DEBU] {28c7fd468e484c1767fb416b86e5557f} Hello world\n2023-03-14 20:22:18.018 [DEBU] {90d2ad828e484c1768fb416bfcde738f} Hello world\n2023-03-14 20:22:19.019 [DEBU] {d05559be8e484c1769fb416baad06f23} Hello world\n"})}),"\n",(0,o.jsx)(n.p,{children:"\u670D\u52A1\u7AEF\u8F93\u51FA\uFF1A"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ go run server.go\n2023-03-14 20:20:06.364 [INFO] pid[96421]: http server started listening on [:61589]\n2023-03-14 20:20:06.364 [INFO] openapi specification is disabled\n2023-03-14 20:20:06.364 [DEBU] service register: &{Head: Deployment: Namespace: Name:hello.svc Version: Endpoints:10.35.12.81:61589 Metadata:map[insecure:true protocol:http]}\n\n   SERVER   | DOMAIN  | ADDRESS | METHOD | ROUTE |                             HANDLER                             |    MIDDLEWARE\n------------|---------|---------|--------|-------|-----------------------------------------------------------------|--------------------\n  hello.svc | default | :61589  | ALL    | /     | main.main.func1                                                 |\n------------|---------|---------|--------|-------|-----------------------------------------------------------------|--------------------\n  hello.svc | default | :61589  | ALL    | /*    | github.com/gogf/gf/v2/net/ghttp.internalMiddlewareServerTracing | GLOBAL MIDDLEWARE\n------------|---------|---------|--------|-------|-----------------------------------------------------------------|--------------------\n\n2023-03-14 20:22:10.006 [INFO] {8054f3a48c484c1760fb416bb3df20a4} request received\n2023-03-14 20:22:11.007 [INFO] {6831cae08c484c1761fb416b9d4df851} request received\n2023-03-14 20:22:12.008 [INFO] {9035761c8d484c1762fb416b1e648b81} request received\n2023-03-14 20:22:13.010 [INFO] {a05a32588d484c1763fb416bc19ff667} request received\n2023-03-14 20:22:14.012 [INFO] {40fdea938d484c1764fb416b8459fc43} request received\n2023-03-14 20:22:15.013 [INFO] {686c9acf8d484c1765fb416b3697d369} request received\n2023-03-14 20:22:16.015 [INFO] {906a470b8e484c1766fb416b85b9867e} request received\n2023-03-14 20:22:17.016 [INFO] {28c7fd468e484c1767fb416b86e5557f} request received\n2023-03-14 20:22:18.017 [INFO] {90d2ad828e484c1768fb416bfcde738f} request received\n2023-03-14 20:22:19.019 [INFO] {d05559be8e484c1769fb416baad06f23} request received\n"})}),"\n",(0,o.jsxs)(n.h3,{id:"grpc-\u5FAE\u670D\u52A1\u793A\u4F8B",children:[(0,o.jsx)(n.code,{children:"GRPC"})," \u5FAE\u670D\u52A1\u793A\u4F8B"]}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.a,{href:"https://github.com/gogf/gf/tree/master/example/rpc/grpcx/basic",children:"https://github.com/gogf/gf/tree/master/example/rpc/grpcx/basic"})}),"\n",(0,o.jsx)(n.h4,{id:"helloworldproto",children:(0,o.jsx)(n.code,{children:"helloworld.proto"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"grpc"})," \u548C ",(0,o.jsx)(n.code,{children:"http"})," \u534F\u8BAE\u6BD4\u8F83\u5927\u7684\u5DEE\u5F02\u5728\u4E8E ",(0,o.jsx)(n.code,{children:"grpc"})," \u9700\u8981\u901A\u8FC7 ",(0,o.jsx)(n.code,{children:"protobuf"})," \u6765\u5B9E\u73B0 ",(0,o.jsx)(n.code,{children:"API"})," \u63A5\u53E3\u4EE5\u53CA\u6570\u636E\u7ED3\u6784\u7684\u5B9A\u4E49\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'syntax = "proto3";\n\npackage protobuf;\n\noption go_package = "github.com/gogf/gf/grpc/example/helloworld/protobuf";\n\n// The greeting service definition.\nservice Greeter {\n  // Sends a greeting\n  rpc SayHello (HelloRequest) returns (HelloReply) {}\n}\n\n// The request message containing the user\'s name.\nmessage HelloRequest {\n  string name = 1;\n}\n\n// The response message containing the greetings\nmessage HelloReply {\n  string message = 1;\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u4EE5\u4E0A ",(0,o.jsx)(n.code,{children:"protobuf"})," \u6587\u4EF6\u901A\u8FC7\u4EE5\u4E0B\u547D\u4EE4\u6267\u884C\u7F16\u8BD1\uFF08\u8BF7\u63D0\u524D\u5B89\u88C5 ",(0,o.jsx)(n.code,{children:"protoc"})," \u5DE5\u5177\uFF09\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"gf gen pb\n"})}),"\n",(0,o.jsxs)(n.p,{children:["\u5C06\u4F1A\u751F\u6210\u5BF9\u5E94\u7684 ",(0,o.jsx)(n.code,{children:"proto go"})," \u6570\u636E\u7ED3\u6784\u6587\u4EF6\u4EE5\u53CA ",(0,o.jsx)(n.code,{children:"grpc"})," \u63A5\u53E3\u6587\u4EF6\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"helloworld.pb.go\nhelloworld_grpc.pb.go\n"})}),"\n",(0,o.jsx)(n.h4,{id:"controllergo",children:(0,o.jsx)(n.code,{children:"controller.go"})}),"\n",(0,o.jsxs)(n.p,{children:["\u63A7\u5236\u5668\u7528\u4E8E\u5B9E\u73B0 ",(0,o.jsx)(n.code,{children:"proto"})," \u4E2D\u5B9A\u4E49\u7684\u63A5\u53E3\u65B9\u6CD5\uFF08\u5982\u679C\u4F7F\u7528\u6846\u67B6\u6807\u51C6\u5316\u5DE5\u7A0B\u76EE\u5F55\u7ED3\u6784\uFF0C\u8BE5\u63A7\u5236\u5668\u4EE3\u7801\u6587\u4EF6\u4E5F\u662F\u7531\u6846\u67B6\u7684 ",(0,o.jsx)(n.code,{children:"gf gen pb"})," \u5DE5\u5177\u81EA\u52A8\u751F\u6210\uFF0C\u5F00\u53D1\u8005\u8FDB\u9700\u8981\u586B\u5145\u5BF9\u5E94\u65B9\u6CD5\u7684\u5177\u4F53\u5B9E\u73B0\u5373\u53EF\uFF09\uFF1A"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:'type Controller struct {\n    protobuf.UnimplementedGreeterServer\n}\n\nfunc Register(s *grpcx.GrpcServer) {\n    protobuf.RegisterGreeterServer(s.Server, &Controller{})\n}\n\n// SayHello implements helloworld.GreeterServer\nfunc (s *Controller) SayHello(ctx context.Context, in *protobuf.HelloRequest) (*protobuf.HelloReply, error) {\n    return &protobuf.HelloReply{Message: "Hello " + in.GetName()}, nil\n}\n'})}),"\n",(0,o.jsx)(n.h4,{id:"configyaml",children:(0,o.jsx)(n.code,{children:"config.yaml"})}),"\n",(0,o.jsxs)(n.p,{children:["\u670D\u52A1\u7AEF\u914D\u7F6E\u6587\u4EF6\uFF0C\u5728\u8BE5\u914D\u7F6E\u6587\u4EF6\u4E2D\u6307\u5B9A\u4E86\u8BE5\u670D\u52A1\u7684\u540D\u79F0\u4E3A ",(0,o.jsx)(n.code,{children:"demo"}),"\u3002\u5FAE\u670D\u52A1\u7684\u540D\u79F0\u7528\u4E8E\u670D\u52A1\u95F4\u901A\u4FE1\u7684\u552F\u4E00\u8BC6\u522B\u6807\u8BC6\u3002\u5728\u4E0D\u663E\u5F0F\u914D\u7F6E\u670D\u52A1\u7AEF\u7684\u76D1\u542C\u7AEF\u53E3\u65F6\uFF0C\u670D\u52A1\u7AEF\u5C06\u4F1A\u968F\u673A\u76D1\u542C\u53EF\u7528\u7684\u672C\u5730\u7AEF\u53E3\u3002\u5728\u5FAE\u670D\u52A1\u6A21\u5F0F\u4E0B\uFF0C\u7531\u4E8E\u4F7F\u7528\u670D\u52A1\u540D\u79F0\u8FDB\u884C\u901A\u4FE1\uFF0C\u670D\u52A1\u7AEF\u53E3\u5F80\u5F80\u4E0D\u9700\u8981\u663E\u5F0F\u6307\u5B9A\uFF0C\u968F\u673A\u76D1\u542C\u5373\u53EF\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'grpc:\n  name:            "demo"\n  logPath:          "./log"\n  logStdout:        true\n  errorLogEnabled:  true\n  accessLogEnabled: true\n  errorStack:       true\n'})}),"\n",(0,o.jsx)(n.h4,{id:"servergo-1",children:(0,o.jsx)(n.code,{children:"server.go"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"grpc"})," \u670D\u52A1\u7AEF\uFF0C\u5728\u4E0D\u663E\u5F0F\u6307\u5B9A\u670D\u52A1\u7AEF\u4F7F\u7528\u7684\u670D\u52A1\u6CE8\u518C\u53D1\u73B0\u7EC4\u4EF6\u65F6\uFF0C\u670D\u52A1\u7AEF\u9ED8\u8BA4\u4F7F\u7528\u7CFB\u7EDF\u6587\u4EF6\u6CE8\u518C\u53D1\u73B0\u7EC4\u4EF6\uFF0C\u8BE5\u7EC4\u4EF6\u4EC5\u7528\u4E8E\u5355\u673A\u6D4B\u8BD5\u3002\u5176\u4E2D\u7684 ",(0,o.jsx)(n.code,{children:"controller.Register"})," \u5373\u8C03\u7528\u6211\u4EEC\u901A\u8FC7\u5DE5\u5177\u751F\u6210\u7684\u63A7\u5236\u5668\u6CE8\u518C\u65B9\u6CD5\u5C06\u5177\u4F53\u7684\u63A5\u53E3\u5B9E\u73B0\u6CE8\u518C\u5230\u670D\u52A1\u7AEF\u4E2D\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n    "github.com/gogf/gf/contrib/rpc/grpcx/v2"\n    "github.com/gogf/gf/example/rpc/grpcx/basic/controller"\n)\n\nfunc main() {\n    s := grpcx.Server.New()\n    controller.Register(s)\n    s.Run()\n}\n'})}),"\n",(0,o.jsx)(n.h4,{id:"clientgo-1",children:(0,o.jsx)(n.code,{children:"client.go"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"grpc"})," \u5BA2\u6237\u7AEF\uFF0C\u5728\u521B\u5EFA\u8FDE\u63A5\u65F6\u9700\u8981\u7ED9\u5B9A\u670D\u52A1\u7AEF\u670D\u52A1\u7684\u5177\u4F53\u540D\u79F0\u3002\u8FD9\u91CC\u7684\u670D\u52A1\u7AEF\u670D\u52A1\u540D\u79F0\u4E3A ",(0,o.jsx)(n.code,{children:"demo"}),"\uFF0C\u6307\u5B9A\u7684\u662F\u4E0A\u9762\u63D0\u5230\u7684\u5FAE\u670D\u52A1\u540D\u79F0\u3002\u5728\u4E0D\u663E\u5F0F\u6307\u5B9A\u5BA2\u6237\u7AEF\u4F7F\u7528\u7684\u670D\u52A1\u6CE8\u518C\u53D1\u73B0\u7EC4\u4EF6\u65F6\uFF0C\u5BA2\u6237\u7AEF\u9ED8\u8BA4\u4F7F\u7528\u7CFB\u7EDF\u6587\u4EF6\u6CE8\u518C\u53D1\u73B0\u7EC4\u4EF6\uFF0C\u8BE5\u7EC4\u4EF6\u4EC5\u7528\u4E8E\u5355\u673A\u6D4B\u8BD5\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n    "github.com/gogf/gf/contrib/rpc/grpcx/v2"\n    "github.com/gogf/gf/example/rpc/grpcx/basic/protobuf"\n    "github.com/gogf/gf/v2/frame/g"\n    "github.com/gogf/gf/v2/os/gctx"\n)\n\nfunc main() {\n    var (\n        ctx    = gctx.New()\n        conn   = grpcx.Client.MustNewGrpcClientConn("demo")\n        client = protobuf.NewGreeterClient(conn)\n    )\n    res, err := client.SayHello(ctx, &protobuf.HelloRequest{Name: "World"})\n    if err != nil {\n        g.Log().Error(ctx, err)\n        return\n    }\n    g.Log().Debug(ctx, "Response:", res.Message)\n}\n'})}),"\n",(0,o.jsx)(n.h4,{id:"\u6267\u884C\u7ED3\u679C-1",children:"\u6267\u884C\u7ED3\u679C"}),"\n",(0,o.jsxs)(n.p,{children:["\u670D\u52A1\u7AEF\u8F93\u51FA\uFF1A\u53EF\u4EE5\u770B\u5230\uFF0C\u670D\u52A1\u7AEF\u8F93\u51FA\u4E86\u4E00\u4E0B ",(0,o.jsx)(n.code,{children:"DEBU"})," \u8C03\u8BD5\u4FE1\u606F\uFF0C\u7528\u4E8E\u663E\u793A\u4E00\u4E9B\u670D\u52A1\u6CE8\u518C\u7684\u7EC6\u8282\u3002\u540C\u65F6\uFF0C\u7531\u4E8E\u6CA1\u6709\u663E\u5F0F\u6307\u5B9A\u670D\u52A1\u7AEF\u7684\u76D1\u542C\u7AEF\u53E3\uFF0C\u8FD9\u91CC\u968F\u673A\u76D1\u542C\u4E86\u672C\u5730\u7AEF\u53E3 ",(0,o.jsx)(n.code,{children:"64517"}),"\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'$ go run server.go\n2023-03-14 20:50:58.465 [DEBU] set default registry using file registry as no custom registry set\n2023-03-14 20:50:58.466 [DEBU] service register: &{Head: Deployment: Namespace: Name:demo Version: Endpoints:10.35.12.81:64517 Metadata:map[protocol:grpc]}\n2023-03-14 20:50:58.466 [INFO] pid[98982]: grpc server started listening on [:64517]\n2023-03-14 20:52:37.059 {9898c809364a4c17da79e47f3e6c3b8f} /protobuf.Greeter/SayHello, 0.003ms, name:"World", message:"Hello World"\n'})}),"\n",(0,o.jsxs)(n.p,{children:["\u5BA2\u6237\u7AEF\u8F93\u51FA\uFF1A\u5BA2\u6237\u7AEF\u901A\u8FC7\u5FAE\u670D\u52A1\u540D\u79F0\u8BBF\u95EE\uFF0C\u5E76\u63A5\u6536\u5230\u4E86\u670D\u52A1\u7AEF\u7684\u8FD4\u56DE\u3002\u6CE8\u610F\u5BA2\u6237\u7AEF\u7684\u65E5\u5FD7\u548C\u670D\u52A1\u7AEF\u7684\u65E5\u5FD7\u4E2D\uFF0C\u94FE\u8DEF\u8DDF\u8E2A\u7684 ",(0,o.jsx)(n.code,{children:"TraceID"})," \u662F\u76F8\u540C\u7684\uFF08 ",(0,o.jsx)(n.code,{children:"9898c809364a4c17da79e47f3e6c3b8f"}),"\uFF09\uFF0C\u8868\u793A\u540C\u4E00\u4E2A\u8BF7\u6C42\u4EA7\u751F\u7684\u65E5\u5FD7\u3002 ",(0,o.jsx)(n.code,{children:"GoFrame"})," \u7684\u5FAE\u670D\u52A1\u7279\u6027\u9ED8\u8BA4\u5F00\u542F\u4E86\u94FE\u8DEF\u8DDF\u8E2A\u80FD\u529B\u3002"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"$ go run client.go\n2023-03-14 20:52:37.060 [DEBU] {9898c809364a4c17da79e47f3e6c3b8f} Response: Hello World\n"})})]})}function a(e={}){let{wrapper:n}={...(0,l.a)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(g,{...e})}):g(e)}},250065:function(e,n,r){r.d(n,{Z:function(){return s},a:function(){return i}});var c=r(667294);let o={},l=c.createContext(o);function i(e){let n=c.useContext(l);return c.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),c.createElement(l.Provider,{value:n},e.children)}}}]);