"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["63979"],{399312:function(e,o,n){n.r(o),n.d(o,{metadata:()=>r,contentTitle:()=>l,default:()=>g,assets:()=>a,toc:()=>d,frontMatter:()=>s});var r=JSON.parse('{"id":"docs/WEB\u670D\u52A1\u5F00\u53D1/\u9AD8\u7EA7\u7279\u6027/\u670D\u52A1\u65E5\u5FD7\u7BA1\u7406","title":"Logging","description":"Using the GoFrame framework for service log management, including the configuration and usage of access logs and error logs. It explains in detail the log configuration objects and attributes, such as Logger, LogPath, ErrorStack, etc., and provides detailed explanations of log formats and custom log handling methods. Additionally, it covers how to set up logs through configuration files and code methods, and provides examples of log formats and error log recording.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/docs/WEB\u670D\u52A1\u5F00\u53D1/\u9AD8\u7EA7\u7279\u6027/\u670D\u52A1\u65E5\u5FD7\u7BA1\u7406.md","sourceDirName":"docs/WEB\u670D\u52A1\u5F00\u53D1/\u9AD8\u7EA7\u7279\u6027","slug":"/docs/web/senior-logging","permalink":"/en/docs/web/senior-logging","draft":false,"unlisted":false,"editUrl":"https://github.com/gogf/gf-site/blob/main/docs/docs/WEB\u670D\u52A1\u5F00\u53D1/\u9AD8\u7EA7\u7279\u6027/\u670D\u52A1\u65E5\u5FD7\u7BA1\u7406.md","tags":[],"version":"current","lastUpdatedBy":"John","lastUpdatedAt":1732541616000,"sidebarPosition":1,"frontMatter":{"slug":"/docs/web/senior-logging","title":"Logging","sidebar_position":1,"hide_title":true,"keywords":["GoFrame","Server Log Management","access log","error log","log configuration","log format","error log","request log","custom log handling","glog"],"description":"Using the GoFrame framework for service log management, including the configuration and usage of access logs and error logs. It explains in detail the log configuration objects and attributes, such as Logger, LogPath, ErrorStack, etc., and provides detailed explanations of log formats and custom log handling methods. Additionally, it covers how to set up logs through configuration files and code methods, and provides examples of log formats and error log recording."},"sidebar":"mainSidebar","previous":{"title":"Static File Service","permalink":"/en/docs/web/senior-static-server"},"next":{"title":"HTTPS & TLS","permalink":"/en/docs/web/senior-https"}}'),t=n("785893"),i=n("250065");let s={slug:"/docs/web/senior-logging",title:"Logging",sidebar_position:1,hide_title:!0,keywords:["GoFrame","Server Log Management","access log","error log","log configuration","log format","error log","request log","custom log handling","glog"],description:"Using the GoFrame framework for service log management, including the configuration and usage of access logs and error logs. It explains in detail the log configuration objects and attributes, such as Logger, LogPath, ErrorStack, etc., and provides detailed explanations of log formats and custom log handling methods. Additionally, it covers how to set up logs through configuration files and code methods, and provides examples of log formats and error log recording."},l=void 0,a={},d=[{value:"Log Configuration",id:"log-configuration",level:2},{value:"Configuration Object",id:"configuration-object",level:3},{value:"Configuration Attributes",id:"configuration-attributes",level:3},{value:"Configuration File",id:"configuration-file",level:3},{value:"Configuration Method",id:"configuration-method",level:3},{value:"Log Format",id:"log-format",level:2},{value:"Request Log",id:"request-log",level:3},{value:"Error Log",id:"error-log",level:3},{value:"Custom Log Handling",id:"custom-log-handling",level:2},{value:"<code>Server</code> Logs and Business Logs",id:"server-logs-and-business-logs",level:2}];function c(e){let o={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(o.p,{children:["The ",(0,t.jsx)(o.code,{children:"GoFrame"})," framework provides comprehensive ",(0,t.jsx)(o.code,{children:"Server"})," log management features, including ",(0,t.jsx)(o.code,{children:"access log"})," and ",(0,t.jsx)(o.code,{children:"error log"}),". It is recommended to use configuration files for unified configuration management."]}),"\n",(0,t.jsx)(o.h2,{id:"log-configuration",children:"Log Configuration"}),"\n",(0,t.jsx)(o.h3,{id:"configuration-object",children:"Configuration Object"}),"\n",(0,t.jsx)(o.p,{children:"Please refer to the API documentation:"}),"\n",(0,t.jsx)(o.p,{children:(0,t.jsx)(o.a,{href:"https://pkg.go.dev/github.com/gogf/gf/v2/net/ghttp#ServerConfig",children:"https://pkg.go.dev/github.com/gogf/gf/v2/net/ghttp#ServerConfig"})}),"\n",(0,t.jsx)(o.h3,{id:"configuration-attributes",children:"Configuration Attributes"}),"\n",(0,t.jsx)(o.p,{children:"The log-related configuration attributes are as follows:"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-go",children:"Logger            *glog.Logger      // Logger for server.\nLogPath           string            // Directory for storing logging files.\nLogStdout         bool              // Printing logging content to stdout.\nErrorStack        bool              // Logging stack information when error.\nErrorLogEnabled   bool              // Enable error logging files.\nErrorLogPattern   string            // Error log file pattern like: error-{Ymd}.log\nAccessLogEnabled  bool              // Enable access logging files.\nAccessLogPattern  string            // Error log file pattern like: access-{Ymd}.log\n"})}),"\n",(0,t.jsx)(o.p,{children:"Brief description:"}),"\n",(0,t.jsxs)(o.ol,{children:["\n",(0,t.jsxs)(o.li,{children:["By default, logs are not output to files and are printed directly to the terminal. By default, the terminal output for the ",(0,t.jsx)(o.code,{children:"access"})," log is disabled, while the ",(0,t.jsx)(o.code,{children:"error"})," log is enabled."]}),"\n",(0,t.jsxs)(o.li,{children:["All options can be set using the ",(0,t.jsx)(o.code,{children:"Server.Set*"})," methods, and most options can be retrieved using the ",(0,t.jsx)(o.code,{children:"Server.Get*"})," methods."]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"Logger"})," is a custom log management object, and developers can also pass a complete log management object to ignore other log option configurations."]}),"\n",(0,t.jsxs)(o.li,{children:["The ",(0,t.jsx)(o.code,{children:"LogPath"})," attribute is used to set the log directory, and logs will be output to log files only when a log directory is set."]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"ErrorLogPattern"})," and ",(0,t.jsx)(o.code,{children:"AccessLogPattern"})," are used to configure the log file name format, defaulting to ",(0,t.jsx)(o.code,{children:"error-{Ymd}.log"})," and ",(0,t.jsx)(o.code,{children:"access-{Ymd}.log"}),", such as ",(0,t.jsx)(o.code,{children:"error-20191212.log"}),", ",(0,t.jsx)(o.code,{children:"access-20191212.log"}),"."]}),"\n",(0,t.jsx)(o.li,{children:"For descriptions of other configuration options, please refer to the comments and API documentation."}),"\n"]}),"\n",(0,t.jsx)(o.h3,{id:"configuration-file",children:"Configuration File"}),"\n",(0,t.jsxs)(o.p,{children:["It is officially recommended to use configuration files to manage service and log configurations. Here is an example of a log configuration (in ",(0,t.jsx)(o.code,{children:"yaml"})," format):"]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-yaml",children:'server:\n  LogPath:          "/var/log/gf-demos/server"\n  LogStdout:        false\n  ErrorStack:       true\n  ErrorLogEnabled:  true\n  ErrorLogPattern:  "error.{Ymd}.log"\n  AccessLogEnabled: true\n  AccessLogPattern: "access.{Ymd}.log"\n'})}),"\n",(0,t.jsxs)(o.p,{children:["When the ",(0,t.jsx)(o.code,{children:"Server"})," starts, it will automatically read the ",(0,t.jsx)(o.code,{children:"server"})," node configuration from the default configuration file ",(0,t.jsx)(o.code,{children:"config.yaml"}),"."]}),"\n",(0,t.jsx)(o.h3,{id:"configuration-method",children:"Configuration Method"}),"\n",(0,t.jsxs)(o.p,{children:["Log configuration can also be done through the ",(0,t.jsx)(o.code,{children:"Set*"})," methods of the ",(0,t.jsx)(o.code,{children:"Server"})," object. Refer to the ",(0,t.jsx)(o.a,{href:"/en/docs/web/server-config",children:"Configuration"})," section."]}),"\n",(0,t.jsx)(o.h2,{id:"log-format",children:"Log Format"}),"\n",(0,t.jsxs)(o.p,{children:["The configuration file method is simpler, so it will not be demonstrated here. The following example uses the configuration method to configure the ",(0,t.jsx)(o.code,{children:"Server"}),"."]}),"\n",(0,t.jsx)(o.h3,{id:"request-log",children:"Request Log"}),"\n",(0,t.jsx)(o.p,{children:"Request log:"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-html",children:'2018-04-20 18:11:57.344 200 "GET http 127.0.0.1:8199 /log/access HTTP/1.1" 0.120, 127.0.0.1, "", "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Ubuntu Chromium/53.0.2785.143 Chrome/53.0.2785.143 Safari/537.36"\n'})}),"\n",(0,t.jsx)(o.p,{children:"Log format:"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-html",children:'Request Time (to the millisecond) HTTP Status Code "Request Method Request Prefix Request Address Request Protocol" Execution Time (seconds) Client IP "Referrer URL", "UserAgent"\n'})}),"\n",(0,t.jsxs)(o.p,{children:["Where ",(0,t.jsx)(o.code,{children:"Request Prefix"})," can be ",(0,t.jsx)(o.code,{children:"http"})," or ",(0,t.jsx)(o.code,{children:"https"}),", and ",(0,t.jsx)(o.code,{children:"Request Protocol"})," is typically ",(0,t.jsx)(o.code,{children:"HTTP/1.0"})," or ",(0,t.jsx)(o.code,{children:"HTTP/1.1"}),"."]}),"\n",(0,t.jsx)(o.admonition,{type:"warning",children:(0,t.jsxs)(o.p,{children:["Note that the ",(0,t.jsx)(o.code,{children:"Execution Time"})," recorded in the logs is in ",(0,t.jsx)(o.code,{children:"seconds"}),", and in most cases, the time you see is almost ",(0,t.jsx)(o.code,{children:"0.xxx"})," seconds, meaning execution times are in milliseconds, less than 1 second."]})}),"\n",(0,t.jsx)(o.h3,{id:"error-log",children:"Error Log"}),"\n",(0,t.jsx)(o.p,{children:"Error log:"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-html",children:'2019-12-20 20:10:56.484 [ERRO] 500, "GET http 127.0.0.1:8199 /log/error HTTP/1.1" 0.210, 127.0.0.1, "", "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/78.0.3904.108 Safari/537.36"\nStack:\n1. OMG\n   1).  main.main.func1\n        /Users/john/Workspace/Go/GOPATH/src/github.com/gogf/gf/.example/net/ghttp/server/log/log_error.go:10\n'})}),"\n",(0,t.jsx)(o.p,{children:"Error information will print the corresponding stack information where the error occurred (excluding internal framework call information) to facilitate error location and developer analysis."}),"\n",(0,t.jsx)(o.admonition,{type:"tip",children:(0,t.jsxs)(o.p,{children:["Any ",(0,t.jsx)(o.code,{children:"panic"})," errors generated by the ",(0,t.jsx)(o.code,{children:"Server"})," will be automatically captured in the error logs. Therefore, for business programs, regardless of whether it's in the controller, business encapsulation layer, or data model, if an error occurs and you want to immediately exit the business request handling, just ",(0,t.jsx)(o.code,{children:"panic"}),"."]})}),"\n",(0,t.jsx)(o.h2,{id:"custom-log-handling",children:"Custom Log Handling"}),"\n",(0,t.jsxs)(o.p,{children:["Developers can customize the handling of ",(0,t.jsx)(o.code,{children:"Server"})," request logs in two ways:"]}),"\n",(0,t.jsxs)(o.ol,{children:["\n",(0,t.jsxs)(o.li,{children:["Custom ",(0,t.jsx)(o.code,{children:"*glog.Logger"})," objects can be passed through log configuration options."]}),"\n",(0,t.jsxs)(o.li,{children:["Interception can be handled uniformly through middleware, as described in the ",(0,t.jsx)(o.a,{href:"/en/docs/web/router-middleware-intro",children:"Middleware - Intro"})," section."]}),"\n"]}),"\n",(0,t.jsxs)(o.h2,{id:"server-logs-and-business-logs",children:[(0,t.jsx)(o.code,{children:"Server"})," Logs and Business Logs"]}),"\n",(0,t.jsxs)(o.p,{children:["This is a ",(0,t.jsx)(o.code,{children:"FAQ"}),"."]}),"\n",(0,t.jsxs)(o.p,{children:["It is important to note that the logs mentioned here are the ",(0,t.jsx)(o.code,{children:"Server"})," logs, similar to a series of logs from ",(0,t.jsx)(o.code,{children:"Web Server"})," services like ",(0,t.jsx)(o.code,{children:"nginx"}),", ",(0,t.jsx)(o.code,{children:"apache"}),", ",(0,t.jsx)(o.code,{children:"tomcat"}),", etc. Only the ",(0,t.jsx)(o.code,{children:"Server"})," is allowed to output content, and developers cannot write log content into the ",(0,t.jsx)(o.code,{children:"Server"})," log files, and the log types and formats are completely fixed."]}),"\n",(0,t.jsxs)(o.p,{children:["The ",(0,t.jsx)(o.code,{children:"GoFrame"})," framework also provides a log module, implemented by the ",(0,t.jsx)(o.code,{children:"glog"})," log component. Logs printed by developers through the ",(0,t.jsx)(o.code,{children:"glog"})," component are considered business logs, and the program's business code can decide what content to output, where to output it, and what the output format should be like. The commonly used ",(0,t.jsx)(o.code,{children:"g.Log()"})," method is used to output business logs, and this method supports automatically reading the ",(0,t.jsx)(o.code,{children:"logger"})," configuration items from the configuration file. Please refer to the ",(0,t.jsx)(o.a,{href:"/en/docs/core/glog",children:"Logging"})," section for more details."]})]})}function g(e={}){let{wrapper:o}={...(0,i.a)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(c,{...e})}):c(e)}},250065:function(e,o,n){n.d(o,{Z:function(){return l},a:function(){return s}});var r=n(667294);let t={},i=r.createContext(t);function s(e){let o=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function l(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:s(e.components),r.createElement(i.Provider,{value:o},e.children)}}}]);