"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["82304"],{577026:function(e,n,o){o.r(n),o.d(n,{metadata:()=>t,contentTitle:()=>r,default:()=>h,assets:()=>a,toc:()=>d,frontMatter:()=>c});var t=JSON.parse('{"id":"docs/\u7EC4\u4EF6\u5217\u8868/NoSQL Redis/Redis-Conn\u5BF9\u8C61","title":"Redis - Conn","description":"Use the Conn object of Redis in the GoFrame framework for long connection operations, such as publish/subscribe functions. Obtain the connection object through a connection pool for operations, while paying attention to connection object timeout issues and closure operations after use. The example code demonstrates implementing the publish/subscribe pattern through Conn, with the program printing data obtained from the Redis Server on the terminal.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/docs/\u7EC4\u4EF6\u5217\u8868/NoSQL Redis/Redis-Conn\u5BF9\u8C61.md","sourceDirName":"docs/\u7EC4\u4EF6\u5217\u8868/NoSQL Redis","slug":"/docs/components/contrib-nosql-redis-conn","permalink":"/en/docs/components/contrib-nosql-redis-conn","draft":false,"unlisted":false,"editUrl":"https://github.com/gogf/gf-site/blob/main/docs/docs/\u7EC4\u4EF6\u5217\u8868/NoSQL Redis/Redis-Conn\u5BF9\u8C61.md","tags":[],"version":"current","lastUpdatedBy":"John","lastUpdatedAt":1732451468000,"sidebarPosition":3,"frontMatter":{"slug":"/docs/components/contrib-nosql-redis-conn","title":"Redis - Conn","sidebar_position":3,"hide_title":true,"keywords":["GoFrame","GoFrame Framework","Redis","Conn Object","Publish/Subscribe","Connection Pool","Long Connection","Connection Timeout","Subscription Mode","Publish Mode"],"description":"Use the Conn object of Redis in the GoFrame framework for long connection operations, such as publish/subscribe functions. Obtain the connection object through a connection pool for operations, while paying attention to connection object timeout issues and closure operations after use. The example code demonstrates implementing the publish/subscribe pattern through Conn, with the program printing data obtained from the Redis Server on the terminal."},"sidebar":"mainSidebar","previous":{"title":"Redis - Do","permalink":"/en/docs/components/contrib-nosql-redis-do-and-serialization"},"next":{"title":"Redis - Interface","permalink":"/en/docs/components/contrib-nosql-redis-interface"}}'),i=o("785893"),s=o("250065");let c={slug:"/docs/components/contrib-nosql-redis-conn",title:"Redis - Conn",sidebar_position:3,hide_title:!0,keywords:["GoFrame","GoFrame Framework","Redis","Conn Object","Publish/Subscribe","Connection Pool","Long Connection","Connection Timeout","Subscription Mode","Publish Mode"],description:"Use the Conn object of Redis in the GoFrame framework for long connection operations, such as publish/subscribe functions. Obtain the connection object through a connection pool for operations, while paying attention to connection object timeout issues and closure operations after use. The example code demonstrates implementing the publish/subscribe pattern through Conn, with the program printing data obtained from the Redis Server on the terminal."},r=void 0,a={},d=[{value:"<code>Conn</code> Object",id:"conn-object",level:2},{value:"Publish/Subscribe",id:"publishsubscribe",level:2}];function l(e){let n={admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.h2,{id:"conn-object",children:[(0,i.jsx)(n.code,{children:"Conn"})," Object"]}),"\n",(0,i.jsxs)(n.p,{children:["If you need to implement long connection operations with ",(0,i.jsx)(n.code,{children:"Redis"})," (such as publish/subscribe), you can use the ",(0,i.jsx)(n.code,{children:"Conn"})," method to obtain a connection object from the connection pool, and then use that connection object for operations. It's important to note that when the connection object is no longer in use, it should be explicitly closed by calling the ",(0,i.jsx)(n.code,{children:"Close"})," method (returned to the connection pool)."]}),"\n",(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["Since the ",(0,i.jsx)(n.code,{children:"Conn"})," is a connection object, be aware that it is subject to connection timeout limits, which relate to server configuration."]})}),"\n",(0,i.jsx)(n.h2,{id:"publishsubscribe",children:"Publish/Subscribe"}),"\n",(0,i.jsxs)(n.p,{children:["You can implement the publish/subscribe pattern through ",(0,i.jsx)(n.code,{children:"Redis"}),"'s ",(0,i.jsx)(n.code,{children:"Conn"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n    "fmt"\n\n    _ "github.com/gogf/gf/contrib/nosql/redis/v2"\n\n    "github.com/gogf/gf/v2/frame/g"\n    "github.com/gogf/gf/v2/os/gctx"\n)\n\nfunc main() {\n    var (\n        ctx     = gctx.New()\n        channel = "channel"\n    )\n    conn, _ := g.Redis().Conn(ctx)\n    defer conn.Close(ctx)\n    _, err := conn.Subscribe(ctx, channel)\n    if err != nil {\n        g.Log().Fatal(ctx, err)\n    }\n    for {\n        msg, err := conn.ReceiveMessage(ctx)\n        if err != nil {\n            g.Log().Fatal(ctx, err)\n        }\n        fmt.Println(msg.Payload)\n    }\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"After execution, the program will block and wait to receive data."}),"\n",(0,i.jsxs)(n.p,{children:["Open another terminal and use the ",(0,i.jsx)(n.code,{children:"redis-cli"})," command to enter the ",(0,i.jsx)(n.code,{children:"Redis Server"})," to publish a message:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"$ redis-cli\n127.0.0.1:6379> publish channel test\n(integer) 1\n127.0.0.1:6379>\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The program terminal will then immediately print the data obtained from the ",(0,i.jsx)(n.code,{children:"Redis Server"}),":"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-test"})})]})}function h(e={}){let{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},250065:function(e,n,o){o.d(n,{Z:function(){return r},a:function(){return c}});var t=o(667294);let i={},s=t.createContext(i);function c(e){let n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);