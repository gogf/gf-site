"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["90317"],{305019:function(e,r,t){t.r(r),t.d(r,{metadata:()=>n,contentTitle:()=>a,default:()=>h,assets:()=>d,toc:()=>l,frontMatter:()=>o});var n=JSON.parse('{"id":"docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u6821\u9A8C/\u6570\u636E\u6821\u9A8C-\u6821\u9A8C\u7ED3\u679C","title":"Data Validation - Result","description":"Using the GoFrame framework for data validation, this document describes the implementation and usage of the gvalid.Error interface. It details methods for obtaining validation error messages, including the impact of sequential and non-sequential validation. Additionally, examples show how to retrieve the first error message from validation errors, providing practical guidance for developers.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u6821\u9A8C/\u6570\u636E\u6821\u9A8C-\u6821\u9A8C\u7ED3\u679C.md","sourceDirName":"docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u6821\u9A8C","slug":"/docs/core/gvalid-result-handling","permalink":"/en/docs/core/gvalid-result-handling","draft":false,"unlisted":false,"editUrl":"https://github.com/gogf/gf-site/blob/main/docs/docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u6821\u9A8C/\u6570\u636E\u6821\u9A8C-\u6821\u9A8C\u7ED3\u679C.md","tags":[],"version":"current","lastUpdatedBy":"John","lastUpdatedAt":1732440306000,"sidebarPosition":2,"frontMatter":{"slug":"/docs/core/gvalid-result-handling","title":"Data Validation - Result","sidebar_position":2,"hide_title":true,"keywords":["GoFrame framework","Data Validation","Validation Results","Error Interface","gvalid.Error","GoFrame v2","Validation Methods","Error Messages","gerror.Current","Sequential Validation"],"description":"Using the GoFrame framework for data validation, this document describes the implementation and usage of the gvalid.Error interface. It details methods for obtaining validation error messages, including the impact of sequential and non-sequential validation. Additionally, examples show how to retrieve the first error message from validation errors, providing practical guidance for developers."},"sidebar":"mainSidebar","previous":{"title":"Data Validation - Object","permalink":"/en/docs/core/gvalid-validator"},"next":{"title":"Data Validation - Data Type","permalink":"/en/docs/core/gvalid-parameter-type"}}'),i=t("785893"),s=t("250065");let o={slug:"/docs/core/gvalid-result-handling",title:"Data Validation - Result",sidebar_position:2,hide_title:!0,keywords:["GoFrame framework","Data Validation","Validation Results","Error Interface","gvalid.Error","GoFrame v2","Validation Methods","Error Messages","gerror.Current","Sequential Validation"],description:"Using the GoFrame framework for data validation, this document describes the implementation and usage of the gvalid.Error interface. It details methods for obtaining validation error messages, including the impact of sequential and non-sequential validation. Additionally, examples show how to retrieve the first error message from validation errors, providing practical guidance for developers."},a=void 0,d={},l=[{value:"Introduction",id:"introduction",level:2},{value:"Support for <code>gerror.Current</code>",id:"support-for-gerrorcurrent",level:2}];function c(e){let r={a:"a",admonition:"admonition",code:"code",h2:"h2",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsxs)(r.p,{children:["The validation result is an ",(0,i.jsx)(r.code,{children:"error"})," object, internally implemented using the ",(0,i.jsx)(r.code,{children:"gvalid.Error"})," object. When data rule validation succeeds, the validation method returns ",(0,i.jsx)(r.code,{children:"nil"}),". When data rule validation fails, the returned object is a structured hierarchical ",(0,i.jsx)(r.code,{children:"map"})," containing multiple fields and their rules along with the corresponding error messages, allowing the receiver to accurately pinpoint the error rules. The related data structure and methods are as follows: ",(0,i.jsx)(r.a,{href:"https://pkg.go.dev/github.com/gogf/gf/v2/util/gvalid",children:"https://pkg.go.dev/github.com/gogf/gf/v2/util/gvalid"})]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-go",children:"type Error interface {\n    Code() gcode.Code\n    Current() error\n    Error() string\n    FirstItem() (key string, messages map[string]error)\n    FirstRule() (rule string, err error)\n    FirstError() (err error)\n    Items() (items []map[string]map[string]error)\n    Map() map[string]error\n    Maps() map[string]map[string]error\n    String() string\n    Strings() (errs []string)\n}\n"})}),"\n",(0,i.jsxs)(r.p,{children:["This data structure can be understood in conjunction with subsequent examples. We can obtain the raw error message data structure ",(0,i.jsx)(r.code,{children:"map"})," through the ",(0,i.jsx)(r.code,{children:"Maps()"})," method. However, in most cases, specific error messages can be conveniently obtained through other methods of the ",(0,i.jsx)(r.code,{children:"Error"})," interface."]}),"\n",(0,i.jsx)(r.admonition,{type:"tip",children:(0,i.jsxs)(r.p,{children:["In most cases, we are not concerned with the specific failed validation rules and can use the ",(0,i.jsx)(r.code,{children:"Error/String"})," method to directly return all error messages. The order of results when obtaining error messages may vary depending on whether the validation rule is sequential."]})}),"\n",(0,i.jsx)(r.p,{children:(0,i.jsx)(r.strong,{children:"Brief Description:"})}),"\n",(0,i.jsx)(r.p,{children:"The value of the validation result can be obtained through multiple validation result methods. To provide developers with a comprehensive understanding, the following details are provided:"}),"\n",(0,i.jsxs)(r.table,{children:[(0,i.jsx)(r.thead,{children:(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.th,{children:"Method"}),(0,i.jsx)(r.th,{children:"Description"})]})}),(0,i.jsxs)(r.tbody,{children:[(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"Code"})}),(0,i.jsxs)(r.td,{children:["Common method. Implements the ",(0,i.jsx)(r.code,{children:"gerror"})," ",(0,i.jsx)(r.code,{children:"Code"})," interface, in which this method consistently returns the error code ",(0,i.jsx)(r.code,{children:"gcode.CodeValidationFailed"})," within the validation component."]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"Error"})}),(0,i.jsxs)(r.td,{children:["Common method. Implements the standard library ",(0,i.jsx)(r.code,{children:"error.Error"})," interface to obtain a string composed of all validation errors. Its internal logic is the same as the ",(0,i.jsx)(r.code,{children:"String"})," method."]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"Current"})}),(0,i.jsxs)(r.td,{children:["Common method. Implements the ",(0,i.jsx)(r.code,{children:"gerror"})," ",(0,i.jsx)(r.code,{children:"Current"})," interface for obtaining the first error object among validation errors."]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"Items"})}),(0,i.jsx)(r.td,{children:"In sequential validation, returns an array of validation errors in the order of validation rules; this order is only valid in sequential validation. Otherwise, the result is random."})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"Map"})}),(0,i.jsxs)(r.td,{children:["Returns the erroneous sub-rule and corresponding error message ",(0,i.jsx)(r.code,{children:"map"})," obtained from ",(0,i.jsx)(r.code,{children:"FirstItem"}),"."]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"Maps"})}),(0,i.jsxs)(r.td,{children:["Returns all error keys and corresponding error rules and error messages ( ",(0,i.jsx)(r.code,{children:"map[string]map[string]error"})," )."]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"String"})}),(0,i.jsxs)(r.td,{children:["Returns all error messages as a single string, with multiple rule error messages connected by ",(0,i.jsx)(r.code,{children:";"}),". Its sequence is only valid when using sequential validation rules; otherwise, the result is random."]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"Strings"})}),(0,i.jsxs)(r.td,{children:["Returns all error messages formed into a ",(0,i.jsx)(r.code,{children:"[]string"})," type. Its sequence is only valid when using sequential validation rules; otherwise, the result is random."]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"FirstItem"})}),(0,i.jsx)(r.td,{children:"When there are multiple key/attribute validation errors, it retrieves the first erroneous key name, along with its corresponding error rule and message. Its sequence is only valid when using sequential validation rules; otherwise, the result is random."})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"FirstRule"})}),(0,i.jsxs)(r.td,{children:["Returns the first erroneous rule and corresponding error message from ",(0,i.jsx)(r.code,{children:"FirstItem"}),". Its sequence is only valid when using sequential validation rules; otherwise, the result is random."]})]}),(0,i.jsxs)(r.tr,{children:[(0,i.jsx)(r.td,{children:(0,i.jsx)(r.code,{children:"FirstString"})}),(0,i.jsxs)(r.td,{children:["Returns the first rule error message from ",(0,i.jsx)(r.code,{children:"FirstRule"}),". Its sequence is only valid when using sequential validation rules; otherwise, the result is random."]})]})]})]}),"\n",(0,i.jsxs)(r.h2,{id:"support-for-gerrorcurrent",children:["Support for ",(0,i.jsx)(r.code,{children:"gerror.Current"})]}),"\n",(0,i.jsxs)(r.p,{children:["We can see that ",(0,i.jsx)(r.code,{children:"gvalid.Error"})," implements the ",(0,i.jsx)(r.code,{children:"Current() error"})," interface, allowing the first error message to be retrieved via the ",(0,i.jsx)(r.code,{children:"gerror.Current"})," method, which is quite convenient for returning error messages when interface validation fails. Let's look at an example:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{className:"language-go",children:'package main\n\nimport (\n    "github.com/gogf/gf/v2/errors/gerror"\n    "github.com/gogf/gf/v2/frame/g"\n    "github.com/gogf/gf/v2/os/gctx"\n    "github.com/gogf/gf/v2/util/gvalid"\n)\n\nfunc main() {\n    type User struct {\n        Name string `v:"required#Please enter user name"`\n        Type int    `v:"required|min:1#|Please select user type"`\n    }\n    var (\n        err  error\n        ctx  = gctx.New()\n        user = User{}\n    )\n    if err = g.Validator().Data(user).Run(ctx); err != nil {\n        g.Dump(err.(gvalid.Error).Maps())\n        g.Dump(gerror.Current(err))\n    }\n}\n'})}),"\n",(0,i.jsxs)(r.p,{children:["Here, ",(0,i.jsx)(r.code,{children:"gerror.Current(err)"})," is used to obtain the first validation error message. After execution, the terminal outputs:"]}),"\n",(0,i.jsx)(r.pre,{children:(0,i.jsx)(r.code,{children:'{\n    "Name": {\n        "required": "Please enter user name",\n    },\n    "Type": {\n        "min": "Please select user type",\n    },\n}\n"Please enter user name"\n'})}),"\n",(0,i.jsx)(r.admonition,{type:"warning",children:(0,i.jsxs)(r.p,{children:["It is important to note that during data validation, ",(0,i.jsx)(r.strong,{children:"sequential validation"})," and ",(0,i.jsx)(r.strong,{children:"non-sequential validation"})," exist, which will affect the result of obtaining the first error message. For details about sequential and non-sequential validation, refer to subsequent chapters."]})})]})}function h(e={}){let{wrapper:r}={...(0,s.a)(),...e.components};return r?(0,i.jsx)(r,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},250065:function(e,r,t){t.d(r,{Z:function(){return a},a:function(){return o}});var n=t(667294);let i={},s=n.createContext(i);function o(e){let r=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),n.createElement(s.Provider,{value:r},e.children)}}}]);