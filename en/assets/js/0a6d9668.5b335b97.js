"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["6695"],{692091:function(e,a,t){t.r(a),t.d(a,{metadata:()=>n,contentTitle:()=>o,default:()=>h,assets:()=>d,toc:()=>l,frontMatter:()=>r});var n=JSON.parse('{"id":"docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM/ORM\u94FE\u5F0F\u64CD\u4F5C/ORM\u94FE\u5F0F\u64CD\u4F5C-\u4E3B\u4ECE\u5207\u6362","title":"ORM Model - Master/Slave","description":"Implement master-slave configuration and read-write separation at the application layer using gdb in the GoFrame framework. With simple configuration, gdb can automatically switch between master and slave, significantly improving database performance and availability. This article also provides examples of using Master and Slave methods for custom node operations, helping developers better address issues related to master-slave synchronization delay and ensure data timeliness and accuracy.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM/ORM\u94FE\u5F0F\u64CD\u4F5C/ORM\u94FE\u5F0F\u64CD\u4F5C-\u4E3B\u4ECE\u5207\u6362.md","sourceDirName":"docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM/ORM\u94FE\u5F0F\u64CD\u4F5C","slug":"/docs/core/gdb-chaining-master-slave","permalink":"/en/docs/core/gdb-chaining-master-slave","draft":false,"unlisted":false,"editUrl":"https://github.com/gogf/gf-site/blob/main/docs/docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM/ORM\u94FE\u5F0F\u64CD\u4F5C/ORM\u94FE\u5F0F\u64CD\u4F5C-\u4E3B\u4ECE\u5207\u6362.md","tags":[],"version":"current","lastUpdatedBy":"John","lastUpdatedAt":1732440306000,"sidebarPosition":9,"frontMatter":{"slug":"/docs/core/gdb-chaining-master-slave","title":"ORM Model - Master/Slave","sidebar_position":9,"hide_title":true,"keywords":["GoFrame","GoFrame Framework","gdb","Master-Slave Switching","Read-Write Separation","Database Configuration","ORM Chaining Operations","SQL Requests","Node Switching","Database Load Balancing"],"description":"Implement master-slave configuration and read-write separation at the application layer using gdb in the GoFrame framework. With simple configuration, gdb can automatically switch between master and slave, significantly improving database performance and availability. This article also provides examples of using Master and Slave methods for custom node operations, helping developers better address issues related to master-slave synchronization delay and ensure data timeliness and accuracy."},"sidebar":"mainSidebar","previous":{"title":"ORM Model - Transaction","permalink":"/en/docs/core/gdb-chaining-transaction"},"next":{"title":"ORM Model - Query Cache","permalink":"/en/docs/core/gdb-chaining-query-cache"}}'),s=t("785893"),i=t("250065");let r={slug:"/docs/core/gdb-chaining-master-slave",title:"ORM Model - Master/Slave",sidebar_position:9,hide_title:!0,keywords:["GoFrame","GoFrame Framework","gdb","Master-Slave Switching","Read-Write Separation","Database Configuration","ORM Chaining Operations","SQL Requests","Node Switching","Database Load Balancing"],description:"Implement master-slave configuration and read-write separation at the application layer using gdb in the GoFrame framework. With simple configuration, gdb can automatically switch between master and slave, significantly improving database performance and availability. This article also provides examples of using Master and Slave methods for custom node operations, helping developers better address issues related to master-slave synchronization delay and ensure data timeliness and accuracy."},o=void 0,d={},l=[];function c(e){let a={code:"code",li:"li",ol:"ol",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(a.p,{children:["From the previous introduction, we know that ",(0,s.jsx)(a.code,{children:"gdb"})," supports master-slave configuration and read-write separation at the application layer, and all features can be achieved through simple configuration. ",(0,s.jsx)(a.code,{children:"gdb"})," will automatically switch between master and slave for SQL requests. The following is a simple master-slave configuration with one master and one slave:"]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-yaml",children:'database:\n  default:\n  - type: "mysql"\n    link: "root:12345678@tcp(192.168.1.1:3306)/test"\n    role: "master"\n  - type: "mysql"\n    link: "root:12345678@tcp(192.168.1.2:3306)/test"\n    role: "slave"\n'})}),"\n",(0,s.jsxs)(a.p,{children:["In most scenarios, our write requests are directed to the ",(0,s.jsx)(a.code,{children:"Master"})," node, while read requests are directed to the ",(0,s.jsx)(a.code,{children:"Slave"})," nodes. This approach helps distribute the load on the database and improves its availability. However, in some cases, we want read operations to be executed on the ",(0,s.jsx)(a.code,{children:"Master"})," node, especially in scenarios with high immediacy requirements (as there is some latency in data synchronization between master and slave nodes)."]}),"\n",(0,s.jsxs)(a.p,{children:["Developers can customize which node a chaining operation is executed on using the ",(0,s.jsx)(a.code,{children:"Master"})," and ",(0,s.jsx)(a.code,{children:"Slave"})," methods."]}),"\n",(0,s.jsxs)(a.p,{children:["Let's look at a simple example. We have an order system with high daily traffic, often causing a ",(0,s.jsx)(a.code,{children:"1-500ms"})," delay in database master-slave synchronization. The business requirement is to display the order list page immediately after creating an order. If the order list page reads data from the slave node by default, users may not see the newly created order due to the database master-slave synchronization delay. To solve this issue, we can configure the order list page to read data from the master node."]}),"\n",(0,s.jsxs)(a.ol,{children:["\n",(0,s.jsxs)(a.li,{children:["\n",(0,s.jsx)(a.p,{children:"When creating an order, there is no need to specify the node for the operation because write operations are executed on the master node by default. To simplify the example, we only show the key code here:"}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-go",children:'g.Model("order").Data(g.Map{\n    "uid"   : 1000,\n    "price" : 99.99,\n    // ...\n}).Insert()\n'})}),"\n"]}),"\n",(0,s.jsxs)(a.li,{children:["\n",(0,s.jsxs)(a.p,{children:["When querying on the order list page, we need to use the ",(0,s.jsx)(a.code,{children:"Master"})," method to specify that the query operation should be conducted on the master node to avoid read delays."]}),"\n",(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-go",children:'g.Model("order").Master().Where("uid", 1000).All()\n'})}),"\n"]}),"\n"]})]})}function h(e={}){let{wrapper:a}={...(0,i.a)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},250065:function(e,a,t){t.d(a,{Z:function(){return o},a:function(){return r}});var n=t(667294);let s={},i=n.createContext(s);function r(e){let a=n.useContext(i);return n.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),n.createElement(i.Provider,{value:a},e.children)}}}]);