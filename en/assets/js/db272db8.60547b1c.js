"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["98377"],{267053(e,r,t){t.r(r),t.d(r,{metadata:()=>i,default:()=>u,frontMatter:()=>d,contentTitle:()=>a,toc:()=>c,assets:()=>n});var i=JSON.parse('{"id":"docs/WEB\u670D\u52A1\u5F00\u53D1/\u8DEF\u7531\u7BA1\u7406/\u8DEF\u7531\u7BA1\u7406-\u4E2D\u95F4\u4EF6\u62E6\u622A\u5668/\u4E2D\u95F4\u4EF6\u62E6\u622A\u5668-\u5E38\u89C1\u95EE\u9898","title":"Middleware - FAQ","description":"Common issues and solutions for modifying request parameters and request Body through middleware when using the GoFrame framework to create websites. Special attention is given to the mechanism of custom parameter overriding and precautions when modifying the request Body to ensure correct handling of HTTP request information in middleware.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/docs/WEB\u670D\u52A1\u5F00\u53D1/\u8DEF\u7531\u7BA1\u7406/\u8DEF\u7531\u7BA1\u7406-\u4E2D\u95F4\u4EF6\u62E6\u622A\u5668/\u4E2D\u95F4\u4EF6\u62E6\u622A\u5668-\u5E38\u89C1\u95EE\u9898.md","sourceDirName":"docs/WEB\u670D\u52A1\u5F00\u53D1/\u8DEF\u7531\u7BA1\u7406/\u8DEF\u7531\u7BA1\u7406-\u4E2D\u95F4\u4EF6\u62E6\u622A\u5668","slug":"/docs/web/router-middleware-faq","permalink":"/en/docs/web/router-middleware-faq","draft":false,"unlisted":false,"editUrl":"https://github.com/gogf/gf-site/blob/main/docs/docs/WEB\u670D\u52A1\u5F00\u53D1/\u8DEF\u7531\u7BA1\u7406/\u8DEF\u7531\u7BA1\u7406-\u4E2D\u95F4\u4EF6\u62E6\u622A\u5668/\u4E2D\u95F4\u4EF6\u62E6\u622A\u5668-\u5E38\u89C1\u95EE\u9898.md","tags":[],"version":"current","lastUpdatedBy":"ChenDasheng","lastUpdatedAt":1752831768000,"sidebarPosition":2,"frontMatter":{"slug":"/docs/web/router-middleware-faq","title":"Middleware - FAQ","sidebar_position":2,"hide_title":true,"keywords":["GoFrame","GoFrame framework","Middleware","Request parameters","Parameter overriding","Request Body","Custom parameters","Request modification","ghttp.Request","HTTP request"],"description":"Common issues and solutions for modifying request parameters and request Body through middleware when using the GoFrame framework to create websites. Special attention is given to the mechanism of custom parameter overriding and precautions when modifying the request Body to ensure correct handling of HTTP request information in middleware."},"sidebar":"mainSidebar","previous":{"title":"Middleware - Examples","permalink":"/en/docs/web/router-middleware-example"},"next":{"title":"API Document","permalink":"/en/docs/web/api-document"}}'),o=t(474848),s=t(28453);let d={slug:"/docs/web/router-middleware-faq",title:"Middleware - FAQ",sidebar_position:2,hide_title:!0,keywords:["GoFrame","GoFrame framework","Middleware","Request parameters","Parameter overriding","Request Body","Custom parameters","Request modification","ghttp.Request","HTTP request"],description:"Common issues and solutions for modifying request parameters and request Body through middleware when using the GoFrame framework to create websites. Special attention is given to the mechanism of custom parameter overriding and precautions when modifying the request Body to ensure correct handling of HTTP request information in middleware."},a,n={},c=[{value:"How to Modify Request Parameters through Middleware",id:"how-to-modify-request-parameters-through-middleware",level:2},{value:"Custom Parameter Overriding",id:"custom-parameter-overriding",level:3},{value:"Modifying Parameters for Specific Request Methods",id:"modifying-parameters-for-specific-request-methods",level:3},{value:"Precautions for Modifying Request Body through Middleware",id:"precautions-for-modifying-request-body-through-middleware",level:2}];function m(e){let r={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",p:"p",strong:"strong",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.h2,{id:"how-to-modify-request-parameters-through-middleware",children:"How to Modify Request Parameters through Middleware"}),"\n",(0,o.jsxs)(r.p,{children:["Before learning how to modify request parameters, please first understand some details about request parameter input: ",(0,o.jsx)(r.a,{href:"/en/docs/web/request",children:"Request \u{1F525}"})]}),"\n",(0,o.jsx)(r.h3,{id:"custom-parameter-overriding",children:"Custom Parameter Overriding"}),"\n",(0,o.jsxs)(r.p,{children:["The simplest way to modify request parameters is to override client-submitted parameters through ",(0,o.jsx)(r.strong,{children:"custom parameters"}),". Since custom parameters have the highest priority in parameter parsing, when ",(0,o.jsx)(r.em,{children:"fully retrieving request parameters"})," (not through specific submission methods), custom parameters will override parameters submitted by other methods. This method of modification is common, especially when using standard routing, where parameters are received as a ",(0,o.jsx)(r.code,{children:"struct"})," object, and the underlying layer retrieves all parameters and then converts them to a ",(0,o.jsx)(r.code,{children:"struct"})," object."]}),"\n",(0,o.jsxs)(r.p,{children:["However, if the user obtains parameters through ",(0,o.jsx)(r.code,{children:"r.GetQuery, r.GetForm"}),", custom parameter overriding will be ineffective. Methods like ",(0,o.jsx)(r.code,{children:"r.Get"})," or ",(0,o.jsx)(r.code,{children:"r.GetRequest"})," for parameter retrieval can also achieve parameter overriding effects."]}),"\n",(0,o.jsx)(r.h3,{id:"modifying-parameters-for-specific-request-methods",children:"Modifying Parameters for Specific Request Methods"}),"\n",(0,o.jsxs)(r.p,{children:["It's also possible to modify the original parameters in middleware by altering ",(0,o.jsx)(r.code,{children:"r.URL.RawQuery"})," or ",(0,o.jsx)(r.code,{children:"r.Body"}),", but after modification, it's necessary to call ",(0,o.jsx)(r.code,{children:"r.ReloadParam()"})," to indicate that the request parameters will need to be re-parsed in the next retrieval."]}),"\n",(0,o.jsx)(r.h2,{id:"precautions-for-modifying-request-body-through-middleware",children:"Precautions for Modifying Request Body through Middleware"}),"\n",(0,o.jsxs)(r.p,{children:["A common issue when modifying ",(0,o.jsx)(r.code,{children:"r.Body"})," through middleware is that ",(0,o.jsx)(r.code,{children:"r.Body"})," can only be read once, and subsequent reads will not retrieve the data, which is by the design of the standard library ",(0,o.jsx)(r.code,{children:"http.Request"}),". In the ",(0,o.jsx)(r.code,{children:"GoFrame"})," framework's ",(0,o.jsx)(r.code,{children:"ghttp.Request"})," object, continuous reading of the ",(0,o.jsx)(r.code,{children:"Body"})," content is allowed using the framework's ",(0,o.jsx)(r.code,{children:"ghttp.Request"})," ",(0,o.jsx)(r.code,{children:"GetBody"}),", ",(0,o.jsx)(r.code,{children:"GetBodyString"})," methods."]}),"\n",(0,o.jsxs)(r.p,{children:["However, if you directly read ",(0,o.jsx)(r.code,{children:"r.Body"})," using the standard library's ",(0,o.jsx)(r.code,{children:"http.Request"})," object within middleware, it is recommended to reassign ",(0,o.jsx)(r.code,{children:"r.Body"})," or wrap and reassign it using ",(0,o.jsx)(r.code,{children:"io.NopCloser"})," to facilitate further reading of ",(0,o.jsx)(r.code,{children:"Body"})," content by subsequent middleware or processes."]})]})}function u(e={}){let{wrapper:r}={...(0,s.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(m,{...e})}):m(e)}},28453(e,r,t){t.d(r,{R:()=>d,x:()=>a});var i=t(296540);let o={},s=i.createContext(o);function d(e){let r=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(r):{...r,...e}},[r,e])}function a(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),i.createElement(s.Provider,{value:r},e.children)}}}]);