"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["60724"],{296055:function(e,t,n){n.r(t),n.d(t,{metadata:()=>r,contentTitle:()=>s,default:()=>h,assets:()=>d,toc:()=>c,frontMatter:()=>i});var r=JSON.parse('{"id":"docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM/ORM\u65B9\u6CD5\u64CD\u4F5C-\u539F\u751F","title":"ORM - Method Ops (Native)","description":"Using the GoFrame framework for native SQL ORM method operations. This guide explains how to execute complex SQL operations through method manipulation, including database queries, data insertion, updating, deletion, and batch operations, providing detailed code examples.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM/ORM\u65B9\u6CD5\u64CD\u4F5C-\u539F\u751F.md","sourceDirName":"docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM","slug":"/docs/core/gdb-funcs","permalink":"/en/docs/core/gdb-funcs","draft":false,"unlisted":false,"editUrl":"https://github.com/gogf/gf-site/blob/main/docs/docs/\u6838\u5FC3\u7EC4\u4EF6/\u6570\u636E\u5E93ORM/ORM\u65B9\u6CD5\u64CD\u4F5C-\u539F\u751F.md","tags":[],"version":"current","lastUpdatedBy":"John","lastUpdatedAt":1732440306000,"sidebarPosition":2,"frontMatter":{"slug":"/docs/core/gdb-funcs","title":"ORM - Method Ops (Native)","sidebar_position":2,"hide_title":true,"keywords":["GoFrame","GoFrame Framework","ORM","SQL Operations","Database Query","Data Insertion","Data Update","Data Deletion","Batch Operations","Chain Operations"],"description":"Using the GoFrame framework for native SQL ORM method operations. This guide explains how to execute complex SQL operations through method manipulation, including database queries, data insertion, updating, deletion, and batch operations, providing detailed code examples."},"sidebar":"mainSidebar","previous":{"title":"ORM Model - Lock","permalink":"/en/docs/core/gdb-chaining-locks"},"next":{"title":"ORM - Transaction","permalink":"/en/docs/core/gdb-transaction"}}'),a=n("785893"),o=n("250065");let i={slug:"/docs/core/gdb-funcs",title:"ORM - Method Ops (Native)",sidebar_position:2,hide_title:!0,keywords:["GoFrame","GoFrame Framework","ORM","SQL Operations","Database Query","Data Insertion","Data Update","Data Deletion","Batch Operations","Chain Operations"],description:"Using the GoFrame framework for native SQL ORM method operations. This guide explains how to execute complex SQL operations through method manipulation, including database queries, data insertion, updating, deletion, and batch operations, providing detailed code examples."},s=void 0,d={},c=[{value:"Method Operations",id:"method-operations",level:2},{value:"Operation Examples",id:"operation-examples",level:2},{value:"1. <code>ORM</code> Object",id:"1-orm-object",level:3},{value:"2. Data Insertion",id:"2-data-insertion",level:3},{value:"3. Data Query (List)",id:"3-data-query-list",level:3},{value:"4. Data Query (Single Record)",id:"4-data-query-single-record",level:3},{value:"5. Data Save",id:"5-data-save",level:3},{value:"6. Batch Operations",id:"6-batch-operations",level:3},{value:"7. Data Update/Delete",id:"7-data-updatedelete",level:3}];function l(e){let t={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,o.a)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{id:"method-operations",children:"Method Operations"}),"\n",(0,a.jsxs)(t.p,{children:["Method operations are used for native ",(0,a.jsx)(t.code,{children:"SQL"})," execution, which are more foundational compared to chain operations. When ",(0,a.jsx)(t.code,{children:"ORM"})," chain operations are unable to handle overly complex ",(0,a.jsx)(t.code,{children:"SQL"})," operations, method operations can be used instead."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.strong,{children:"API Documentation:"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.a,{href:"https://pkg.go.dev/github.com/gogf/gf/v2/database/gdb#DB",children:"https://pkg.go.dev/github.com/gogf/gf/v2/database/gdb#DB"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.strong,{children:"Common Methods:"})}),"\n",(0,a.jsx)(t.p,{children:"The list of methods in this document may lag behind the code. For a detailed list of methods, please refer to the API documentation. The following methods are for reference only."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:"// SQL operation methods, returning native standard library sql objects\nQuery(ctx context.Context, query string, args ...interface{}) (*sql.Rows, error)\nExec(ctx context.Context, query string, args ...interface{}) (sql.Result, error)\nPrepare(ctx context.Context, query string) (*sql.Stmt, error)\n\n// Database record queries:\n// Query single record, query multiple records, get record object, query single field value (similar to chain operations)\nGetAll(ctx context.Context, sql string, args ...interface{}) (Result, error)\nGetOne(ctx context.Context, sql string, args ...interface{}) (Record, error)\nGetValue(ctx context.Context, sql string, args ...interface{}) (Value, error)\nGetArray(ctx context.Context, sql string, args ...interface{}) ([]Value, error)\nGetCount(ctx context.Context, sql string, args ...interface{}) (int, error)\nGetScan(ctx context.Context, objPointer interface{}, sql string, args ...interface{}) error\n\n// Single data operation\nInsert(ctx context.Context, table string, data interface{}, batch...int) (sql.Result, error)\nReplace(ctx context.Context, table string, data interface{}, batch...int) (sql.Result, error)\nSave(ctx context.Context, table string, data interface{}, batch...int) (sql.Result, error)\n\n// Data update/delete\nUpdate(ctx context.Context, table string, data interface{}, condition interface{}, args ...interface{}) (sql.Result, error)\nDelete(ctx context.Context, table string, condition interface{}, args ...interface{}) (sql.Result, error)\n"})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.strong,{children:"Brief Description:"})}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"Query"})," is the original data query method that returns the native standard library's result set object, requiring manual parsing. It is recommended to use the ",(0,a.jsx)(t.code,{children:"Get*"})," methods, which automatically parse the results."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.code,{children:"Exec"})," is used for ",(0,a.jsx)(t.code,{children:"SQL"})," operations related to writing/updating."]}),"\n",(0,a.jsxs)(t.li,{children:["It is recommended to use the ",(0,a.jsx)(t.code,{children:"Get*"})," series of query methods for data queries."]}),"\n",(0,a.jsxs)(t.li,{children:["The ",(0,a.jsx)(t.code,{children:"data"})," parameter in the ",(0,a.jsx)(t.code,{children:"Insert"}),"/",(0,a.jsx)(t.code,{children:"Replace"}),"/",(0,a.jsx)(t.code,{children:"Save"})," methods supports data types: ",(0,a.jsx)(t.code,{children:"string/map/slice/struct/*struct"}),". When passed as a ",(0,a.jsx)(t.code,{children:"slice"})," type, it is automatically recognized as a batch operation, and the ",(0,a.jsx)(t.code,{children:"batch"})," parameter is effective."]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"operation-examples",children:"Operation Examples"}),"\n",(0,a.jsxs)(t.h3,{id:"1-orm-object",children:["1. ",(0,a.jsx)(t.code,{children:"ORM"})," Object"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:'// Get the database object with default configuration (configuration name is "default")\ndb := g.DB()\n\n// Get the database object with the configuration group name "user-center"\ndb := g.DB("user-center")\n\n// Use the native singleton management method to get the database object singleton\ndb, err := gdb.Instance()\ndb, err := gdb.Instance("user-center")\n\n// Note that there is no need to use the Close method to close the database connection when not in use (and gdb does not provide a Close method).\n// The underlying design of the database engine uses connection pooling, and the connection will automatically close when it is no longer in use.\n'})}),"\n",(0,a.jsx)(t.h3,{id:"2-data-insertion",children:"2. Data Insertion"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:'r, err := db.Insert(ctx, "user", gdb.Map {\n    "name": "john",\n})\n'})}),"\n",(0,a.jsx)(t.h3,{id:"3-data-query-list",children:"3. Data Query (List)"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:'list, err := db.GetAll(ctx, "select * from user limit 2")\nlist, err := db.GetAll(ctx, "select * from user where age > ? and name like ?", g.Slice{18, "%john%"})\nlist, err := db.GetAll(ctx, "select * from user where status=?", g.Slice{1})\n'})}),"\n",(0,a.jsx)(t.h3,{id:"4-data-query-single-record",children:"4. Data Query (Single Record)"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:'one, err := db.GetOne(ctx, "select * from user limit 2")\none, err := db.GetOne(ctx, "select * from user where uid=1000")\none, err := db.GetOne(ctx, "select * from user where uid=?", 1000)\none, err := db.GetOne(ctx, "select * from user where uid=?", g.Slice{1000})\n'})}),"\n",(0,a.jsx)(t.h3,{id:"5-data-save",children:"5. Data Save"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:'r, err := db.Save(ctx, "user", gdb.Map {\n    "uid"  :  1,\n    "name" : "john",\n})\n'})}),"\n",(0,a.jsx)(t.h3,{id:"6-batch-operations",children:"6. Batch Operations"}),"\n",(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"batch"})," parameter is used to specify the number of records to be written in batches during batch operations (default is ",(0,a.jsx)(t.code,{children:"10"}),")."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:'_, err := db.Insert(ctx, "user", gdb.List {\n    {"name": "john_1"},\n    {"name": "john_2"},\n    {"name": "john_3"},\n    {"name": "john_4"},\n}, 10)\n'})}),"\n",(0,a.jsx)(t.h3,{id:"7-data-updatedelete",children:"7. Data Update/Delete"}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-go",children:'// db.Update/db.Delete likewise\n// UPDATE `user` SET `name`=\'john\' WHERE `uid`=10000\nr, err := db.Update(ctx, "user", gdb.Map {"name": "john"}, "uid=?", 10000)\n// UPDATE `user` SET `name`=\'john\' WHERE `uid`=10000\nr, err := db.Update(ctx, "user", "name=\'john\'", "uid=10000")\n// UPDATE `user` SET `name`=\'john\' WHERE `uid`=10000\nr, err := db.Update(ctx, "user", "name=?", "uid=?", "john", 10000)\n'})}),"\n",(0,a.jsxs)(t.p,{children:["Note that it is supported and recommended to use prepared statement mode (using ",(0,a.jsx)(t.code,{children:"?"})," placeholders) for input to avoid ",(0,a.jsx)(t.code,{children:"SQL"})," injection risks."]})]})}function h(e={}){let{wrapper:t}={...(0,o.a)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}},250065:function(e,t,n){n.d(t,{Z:function(){return s},a:function(){return i}});var r=n(667294);let a={},o=r.createContext(a);function i(e){let t=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function s(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);