"use strict";(self.webpackChunkgf_site=self.webpackChunkgf_site||[]).push([["89481"],{497580:function(e,n,t){t.r(n),t.d(n,{metadata:()=>r,contentTitle:()=>s,default:()=>p,assets:()=>a,toc:()=>d,frontMatter:()=>c});var r=JSON.parse('{"id":"docs/\u7EC4\u4EF6\u5217\u8868/\u7F51\u7EDC\u7EC4\u4EF6/TCP\u7EC4\u4EF6/TCP\u7EC4\u4EF6-TLS\u52A0\u5BC6","title":"TCP - TLS","description":"Using GoFrame framework\'s gtcp module to implement TLS encrypted communication in environments with high security requirements. Through provided sample code, we explain how to create TLS servers and clients, how to use certificates for encrypted data transmission, and how to handle potential certificate expiration issues. This is crucial for developers who need to securely transmit data.","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/docs/\u7EC4\u4EF6\u5217\u8868/\u7F51\u7EDC\u7EC4\u4EF6/TCP\u7EC4\u4EF6/TCP\u7EC4\u4EF6-TLS\u52A0\u5BC6.md","sourceDirName":"docs/\u7EC4\u4EF6\u5217\u8868/\u7F51\u7EDC\u7EC4\u4EF6/TCP\u7EC4\u4EF6","slug":"/docs/components/network-gtcp-tls","permalink":"/en/docs/components/network-gtcp-tls","draft":false,"unlisted":false,"editUrl":"https://github.com/gogf/gf-site/blob/main/docs/docs/\u7EC4\u4EF6\u5217\u8868/\u7F51\u7EDC\u7EC4\u4EF6/TCP\u7EC4\u4EF6/TCP\u7EC4\u4EF6-TLS\u52A0\u5BC6.md","tags":[],"version":"current","lastUpdatedBy":"John","lastUpdatedAt":1740621099000,"sidebarPosition":2,"frontMatter":{"slug":"/docs/components/network-gtcp-tls","title":"TCP - TLS","sidebar_position":2,"hide_title":true,"keywords":["GoFrame","GoFrame Framework","gtcp","TLS Encryption","Network Communication","Go Language","Server","Client","Secure Communication","Network Security"],"description":"Using GoFrame framework\'s gtcp module to implement TLS encrypted communication in environments with high security requirements. Through provided sample code, we explain how to create TLS servers and clients, how to use certificates for encrypted data transmission, and how to handle potential certificate expiration issues. This is crucial for developers who need to securely transmit data."},"sidebar":"mainSidebar","previous":{"title":"TCP - Methods","permalink":"/en/docs/components/network-gtcp-funcs"},"next":{"title":"TCP - Connection Pool","permalink":"/en/docs/components/network-gtcp-connection-pool"}}'),i=t("785893"),o=t("250065");let c={slug:"/docs/components/network-gtcp-tls",title:"TCP - TLS",sidebar_position:2,hide_title:!0,keywords:["GoFrame","GoFrame Framework","gtcp","TLS Encryption","Network Communication","Go Language","Server","Client","Secure Communication","Network Security"],description:"Using GoFrame framework's gtcp module to implement TLS encrypted communication in environments with high security requirements. Through provided sample code, we explain how to create TLS servers and clients, how to use certificates for encrypted data transmission, and how to handle potential certificate expiration issues. This is crucial for developers who need to securely transmit data."},s=void 0,a={},d=[];function l(e){let n={a:"a",code:"code",p:"p",pre:"pre",...(0,o.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"gtcp"})," module supports ",(0,i.jsx)(n.code,{children:"TLS"})," encrypted communication servers and clients, which are essential in scenarios with high security demands. A ",(0,i.jsx)(n.code,{children:"TLS"})," server can be created using either the ",(0,i.jsx)(n.code,{children:"NewServerTLS"})," or ",(0,i.jsx)(n.code,{children:"NewServerKeyCrt"})," methods. A ",(0,i.jsx)(n.code,{children:"TLS"})," client can be created using either the ",(0,i.jsx)(n.code,{children:"NewConnKeyCrt"})," or ",(0,i.jsx)(n.code,{children:"NewConnTLS"})," methods."]}),"\n",(0,i.jsx)(n.p,{children:"Examples:"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/gogf/gf/tree/master/.example/net/gtcp/tls",children:"https://github.com/gogf/gf/tree/master/.example/net/gtcp/tls"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n    "fmt"\n    "github.com/gogf/gf/v2/frame/g"\n    "github.com/gogf/gf/v2/net/gtcp"\n    "github.com/gogf/gf/v2/util/gconv"\n    "time"\n)\n\nfunc main() {\n    address := "127.0.0.1:8999"\n    crtFile := "server.crt"\n    keyFile := "server.key"\n    // TLS Server\n    go gtcp.NewServerKeyCrt(address, crtFile, keyFile, func(conn *gtcp.Conn) {\n        defer conn.Close()\n        for {\n            data, err := conn.Recv(-1)\n            if len(data) > 0 {\n                fmt.Println(string(data))\n            }\n            if err != nil {\n                // if client closes, err will be: EOF\n                g.Log().Error(err)\n                break\n            }\n        }\n    }).Run()\n\n    time.Sleep(time.Second)\n\n    // Client\n    conn, err := gtcp.NewConnKeyCrt(address, crtFile, keyFile)\n    if err != nil {\n        panic(err)\n    }\n    defer conn.Close()\n    for i := 0; i < 10; i++ {\n        if err := conn.Send([]byte(gconv.String(i))); err != nil {\n            g.Log().Error(err)\n        }\n        time.Sleep(time.Second)\n        if i == 5 {\n            conn.Close()\n            break\n        }\n    }\n\n    // exit after 5 seconds\n    time.Sleep(5 * time.Second)\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"After execution, you may see an error reported when the client is running:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"panic: x509: certificate has expired or is not yet valid\n"})}),"\n",(0,i.jsx)(n.p,{children:"This is because our certificate was manually created and has expired. For demonstration purposes, we ignored the client's verification of the certificate in the client code."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'package main\n\nimport (\n    "fmt"\n    "github.com/gogf/gf/v2/net/gtcp"\n    "github.com/gogf/gf/v2/util/gconv"\n    "time"\n)\n\nfunc main() {\n    address := "127.0.0.1:8999"\n    crtFile := "server.crt"\n    keyFile := "server.key"\n    // TLS Server\n    go gtcp.NewServerKeyCrt(address, crtFile, keyFile, func(conn *gtcp.Conn) {\n        defer conn.Close()\n        for {\n            data, err := conn.Recv(-1)\n            if len(data) > 0 {\n                fmt.Println(string(data))\n            }\n            if err != nil {\n                // if client closes, err will be: EOF\n                g.Log().Error(err)\n                break\n            }\n        }\n    }).Run()\n\n    time.Sleep(time.Second)\n\n    // Client\n    tlsConfig, err := gtcp.LoadKeyCrt(crtFile, keyFile)\n    if err != nil {\n        panic(err)\n    }\n    tlsConfig.InsecureSkipVerify = true\n\n    conn, err := gtcp.NewConnTLS(address, tlsConfig)\n    if err != nil {\n        panic(err)\n    }\n    defer conn.Close()\n    for i := 0; i < 10; i++ {\n        if err := conn.Send([]byte(gconv.String(i))); err != nil {\n            g.Log().Error(err)\n        }\n        time.Sleep(time.Second)\n        if i == 5 {\n            conn.Close()\n            break\n        }\n    }\n\n    // exit after 5 seconds\n    time.Sleep(5 * time.Second)\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Upon execution, the terminal output is:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-0",children:"1\n2\n3\n4\n5\n2019-06-05 00:13:12.488 [ERRO] EOF\nStack:\n1. /Users/john/Workspace/Go/GOPATH/src/github.com/gogf/gf/v2/geg/net/gtcp/tls/gtcp_server_client.go:25\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Here, the client closes the connection after ",(0,i.jsx)(n.code,{children:"5"})," seconds, resulting in the server receiving an ",(0,i.jsx)(n.code,{children:"EOF"})," error when receiving data. In practice, this kind of error can be ignored; the server can simply close the client's connection upon encountering this error."]})]})}function p(e={}){let{wrapper:n}={...(0,o.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},250065:function(e,n,t){t.d(n,{Z:function(){return s},a:function(){return c}});var r=t(667294);let i={},o=r.createContext(i);function c(e){let n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);